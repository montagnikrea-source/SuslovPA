
// ‚ö†Ô∏è –ó–ê–©–ò–©–ï–ù–ù–´–ô –ö–û–î - –ö–û–ü–ò–†–û–í–ê–ù–ò–ï –ó–ê–ü–†–ï–©–ï–ù–û ‚ö†Ô∏è
// ¬© 2025 SuslovPA - –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã
// –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Å–ª–µ–¥—É–µ—Ç—Å—è –ø–æ –∑–∞–∫–æ–Ω—É
//
// Anti-copy protection active
(function(){
  if(window.location.hostname !== 'montagnikrea-source.github.io' && 
     window.location.hostname !== 'localhost' && 
     window.location.hostname !== '127.0.0.1') {
    document.body.innerHTML = '<h1>‚õî –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω</h1><p>–≠—Ç–æ—Ç –∫–æ–¥ –∑–∞—â–∏—â–µ–Ω –æ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.</p>';
    return;
  }
})();

// –ó–∞—â–∏—Ç–∞ –æ—Ç DevTools
let devtools = {open: false, orientation: null};
setInterval(function(){
  if(window.outerHeight - window.innerHeight > 160 || window.outerWidth - window.innerWidth > 160) {
    if(!devtools.open) {
      devtools.open = true;
      console.clear();
      console.log('%c‚õî –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï', 'color:red;font-size:30px;font-weight:bold;');
      console.log('%c–≠—Ç–æ—Ç –∫–æ–¥ –∑–∞—â–∏—â–µ–Ω –∞–≤—Ç–æ—Ä—Å–∫–∏–º –ø—Ä–∞–≤–æ–º!', 'color:red;font-size:16px;');
    }
  } else {
    devtools.open = false;
  }
}, 500);

// –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–∏ –º—ã—à–∏
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('selectstart', e => e.preventDefault());
document.addEventListener('dragstart', e => e.preventDefault());

// –ó–∞—â–∏—Ç–∞ –æ—Ç –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à
document.addEventListener('keydown', function(e) {
  if(e.key === 'F12' || 
     (e.ctrlKey && e.shiftKey && e.key === 'I') ||
     (e.ctrlKey && e.shiftKey && e.key === 'C') ||
     (e.ctrlKey && e.key === 'U') ||
     (e.ctrlKey && e.key === 'S')) {
    e.preventDefault();
    return false;
  }
});

<!DOCTYPE html> <html lang="ru"> <head> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Frequency Scanner ‚Äî Neuro Homeostasis J‚Üí0 (with AdSense Auto Ads)</title> <!-- (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –£–∫–∞–∂–∏ –∞–∫–∫–∞—É–Ω—Ç AdSense –¥–ª—è –º–µ—Ç–∞-—Å–∫–∞–Ω–µ—Ä–æ–≤ --> <meta name="google-adsense-account" content="ca-pub-1128500581050725"> <!-- ‚úÖ Google AdSense Auto Ads (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∫–ª–∞–º–∞) --> <script async src="https: crossorigin="anonymous"></script> <!-- Firebase –¥–ª—è –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —á–∞—Ç–∞ --> <script src="https: <script src="https: <style> :root { --bg:#f3f5f7; --panel:#fff; --muted:#556; --bar:#e8ebef; } html,body{margin:0;background:var(--bg);font:14px/1.45 system-ui,Segoe UI,Arial} .main-container{display:flex;gap:24px;max-width:1400px;margin:24px auto;padding:24px} .wrap{flex:1;padding:24px;background:var(--panel);border-radius:16px;box-shadow:0 2px 22px rgba(0,0,0,.07)} .chat-container{width:350px;background:var(--panel);border-radius:16px;box-shadow:0 2px 22px rgba(0,0,0,.07);padding:20px;display:flex;flex-direction:column;height:fit-content;position:sticky;top:24px} h1{margin:0 0 10px} #loading{margin:6px 0 12px} #loading .bg{height:18px;border-radius:8px;background:var(--bar);overflow:hidden} #loading .fill{height:100%;width:0%;background:linear-gradient(90deg,#0a7cff 60%,#69b7ff);transition:width .25s ease-out} #statusText{color:var(--muted);margin-top:6px} .row{margin-top:12px} .lbl{margin:10px 0 6px} .bar{height:18px;border-radius:8px;background:var(--bar);overflow:hidden} .f{height:100%;background:linear-gradient(90deg,#0a7cff 60%,#69b7ff);width:0%} .i{height:100%;background:linear-gradient(90deg,#18b56c 60%,#9ef0c5);width:0%} .c{height:100%;background:linear-gradient(90deg,#ff9800 60%,#ffd699);width:0%} #info{margin-top:14px;font-family:ui-monospace,Consolas,Menlo,monospace;white-space:pre-wrap;color:#222} .hint{color:#444;margin-top:8px} .ad-placeholder { min-height: 250px; display:block; text-align:center; margin:16px 0; background:transparent; } .chat-header{text-align:center;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid #e8ebef} .chat-header h3{margin:0;color:#333;font-size:18px} .chat-messages{height:400px;overflow-y:auto;border:1px solid #e8ebef;border-radius:8px;padding:12px;margin-bottom:16px;background:#fafbfc} .message{margin-bottom:12px;padding:8px 12px;border-radius:12px;max-width:85%;word-wrap:break-word} .message.user{background:#007bff;color:white;margin-left:auto} .message.other{background:#f1f3f5;color:#333} .message-meta{font-size:11px;opacity:0.7;margin-top:4px} .chat-input{display:flex;gap:8px} .chat-input input{flex:1;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:14px} .chat-input button{padding:10px 16px;background:#007bff;color:white;border:none;border-radius:6px;cursor:pointer;font-size:14px;transition:background-color 0.3s} .chat-input button:hover{background:#0056b3} .chat-input button:disabled{background:#6c757d;cursor:wait;opacity:0.7} .chat-input button:disabled{background:#ccc;cursor:not-allowed} .message-count{text-align:center;color:#666;font-size:12px;margin-bottom:8px} .filter-notice{background:#fff3cd;border:1px solid #ffeaa7;color:#856404;padding:8px;border-radius:6px;font-size:12px;margin-bottom:12px} .online-count{background:#d4edda;border:1px solid #c3e6cb;color:#155724;padding:8px;border-radius:6px;font-size:12px;margin-bottom:8px;text-align:center} .username-input{margin-bottom:12px} .username-input input{width:100%;padding:8px;border:1px solid #ddd;border-radius:6px;font-size:14px} .message.system{background:#e2e3e5;color:#6c757d;font-style:italic;margin:5px auto;text-align:center;max-width:95%} @media (max-width: 1200px) { .main-container{flex-direction:column} .chat-container{width:100%;position:relative;top:0} } .nav-header { background: #f8f9fa; padding: 10px 0; margin-bottom: 20px; border-radius: 8px; text-align: center; } .nav-header a { margin: 0 10px; color: #007bff; text-decoration: none; padding: 6px 12px; border-radius: 4px; font-size: 14px; } .nav-header a:hover { background: #007bff; color: white; } </style> </head> <body> <div class="nav-header"> <a href="../">üè† –ì–ª–∞–≤–Ω–∞—è</a> <a href="./">üìä Frequency Scanner</a> <a href="../about.html">üìñ –û –Ω–∞—Å</a> <a href="../contact.html">üìß –ö–æ–Ω—Ç–∞–∫—Ç—ã</a> <a href="../privacy-policy.html">üîí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</a> </div> <div class="main-container"> <div class="wrap"> <h1>Frequency Scanner ‚Äî Homeostatic Zero-Target (CPU-only, Neuro J‚Üí0)</h1> <div id="loading"> <div class="bg"><div id="loadingBar" class="fill"></div></div> <div id="statusText">–ü–ª–∞–≤–Ω–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ‚Ä¶</div> </div> <div class="row"> <div class="lbl">–ß–∞—Å—Ç–æ—Ç–∞ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–π (–ì—Ü): <span id="freqValue">0</span></div> <div class="bar"><div id="freqBar" class="f"></div></div> <div class="lbl">–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (%): <span id="inertiaValue">0</span></div> <div class="bar"><div id="inertiaBar" class="i"></div></div> <div class="lbl">–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: <span id="confValue">0</span></div> <div class="bar"><div id="confBar" class="c"></div></div> </div> <!-- –ü–∞–Ω–µ–ª—å –∞–≤—Ç/—Ä—É—á–Ω. –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ–π—Ä–æ–æ–±—É—á–µ–Ω–∏—è --> <div class="row controls" style="margin-top:18px;padding:12px;border-radius:12px;background:#f7f9fb;border:1px solid #e7ecf2"> <div class="lbl" style="margin-top:0">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è (–æ–Ω–ª–∞–π–Ω):</div> <div style="display:grid;grid-template-columns:180px 1fr 80px 84px;gap:8px;align-items:center"> <div>Learning rate (lr)</div> <input id="lrSlider" type="range" min="0.001" max="0.2" step="0.001" value="0.030"/> <div><span id="lrVal">0.030</span></div> <label style="display:flex;gap:6px;align-items:center;white-space:nowrap"><input id="lrAuto" type="checkbox" checked/> AUTO</label> <div>L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (l2)</div> <input id="l2Slider" type="range" min="0.0" max="0.01" step="0.0001" value="0.0001"/> <div><span id="l2Val">0.0001</span></div> <label style="display:flex;gap:6px;align-items:center;white-space:nowrap"><input id="l2Auto" type="checkbox" checked/> AUTO</label> <div>–°–º–µ—à–∏–≤–∞–Ω–∏–µ NN/PI (mix)</div> <input id="mixSlider" type="range" min="0.0" max="1.0" step="0.01" value="0.75"/> <div><span id="mixVal">0.75</span></div> <label style="display:flex;gap:6px;align-items:center;white-space:nowrap"><input id="mixAuto" type="checkbox" checked/> AUTO</label> </div> <div class="hint" style="margin-top:8px">AUTO ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏; —Å–Ω–∏–º–∏—Ç–µ —Ñ–ª–∞–∂–æ–∫, —á—Ç–æ–±—ã —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é.</div> </div> <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ù–ï–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô —Ä—É—á–Ω–æ–π —Ä–µ–∫–ª–∞–º–Ω—ã–π –±–ª–æ–∫ (Responsive) –í–ù–ò–ú–ê–ù–ò–ï: –ß—Ç–æ–±—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª, –∑–∞–º–µ–Ω–∏ data-ad-slot –Ω–∞ —Å–≤–æ–π –≤ –∫–∞–±–∏–Ω–µ—Ç–µ AdSense. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ Auto Ads ‚Äî –æ—Å—Ç–∞–≤—å —ç—Ç–æ—Ç –±–ª–æ–∫ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º. <ins class="adsbygoogle ad-placeholder" data-ad-client="ca-pub-1128500581050725" data-ad-slot="REPLACE_WITH_YOUR_SLOT_ID_1" data-ad-format="auto" data-full-width-responsive="true"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ --> <div id="info"></div> <div class="hint">–¶–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏ ‚Äî J‚Üí0: |œÜ|, |Œîf|, Var(Œîf), |u|, (1‚àíconf), (1‚àíinertia) ‚Üí 0. –ù–µ–π—Ä–æ-–≥–æ–º–µ–æ—Å—Ç–∞–∑ —Å lock-–∑–∞—â–∏—Ç–æ–π –∏ –∞–≤—Ç–æ/—Ä—É—á–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º lr/l2/mix.</div> </div> <!-- –ß–∞—Ç —Å –æ—Ç–∑—ã–≤–∞–º–∏ --> <div class="chat-container"> <div class="chat-header"> <h3>üí¨ –û—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3> </div> <div class="filter-notice"> üõ°Ô∏è –°–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ñ–∏–ª—å—Ç—Ä–æ–º </div> <div class="online-count" id="onlineCount"> üë• –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º: <span id="connectionStatus">–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è...</span> <div id="connectionStability" style="font-size: 10px; margin-top: 2px; color: #666;"></div> </div> <div class="telegram-info" style="margin: 10px 0; padding: 10px; background: #e3f2fd; border-left: 4px solid #2196f3; border-radius: 4px; font-size: 12px;"> üì± <strong>Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:</strong> –ß–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Telegram Bot API –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.<br> üîó <strong>–ê–∫—Ç–∏–≤–Ω—ã–π –∫–∞–Ω–∞–ª:</strong> <a href="https: ü§ñ <strong>–ë–æ—Ç:</strong> <a href="https: <button onclick="_h6a9htgy.retryTelegramConnection()" style="margin-top: 5px; padding: 5px 10px; background: #2196f3; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;"> üîÑ –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Telegram </button> <button onclick="_h6a9htgy.syncTelegramMessages()" style="margin-left: 5px; padding: 5px 10px; background: #4CAF50; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;"> üì• –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è </button> <button onclick="_h6a9htgy.testTelegramSending()" style="margin-left: 5px; padding: 5px 10px; background: #FF9800; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;"> üß™ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ </button> <button onclick="_h6a9htgy.showTelegramDiagnostics()" style="margin-left: 5px; padding: 5px 10px; background: #9C27B0; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;"> üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Telegram </button> <button onclick="_h6a9htgy.checkBotToken()" style="margin-left: 5px; padding: 5px 10px; background: #E91E63; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;"> üîë –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω </button> <button onclick="_h6a9htgy.checkChannelAccess()" style="margin-left: 5px; padding: 5px 10px; background: #00BCD4; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;"> üì¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–Ω–∞–ª </button> <button onclick="_h6a9htgy.checkBotSettings()" style="margin-left: 5px; padding: 5px 10px; background: #9C27B0; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;"> ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ </button><br> <details style="margin-top: 5px;"> <summary style="cursor: pointer; color: #1976d2;">üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–æ—Ç–∞ –∏ –∫–∞–Ω–∞–ª–∞</summary> <div style="margin-top: 5px; padding: 5px;"> <strong>ü§ñ –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞:</strong><br> 1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ @BotFather<br> 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /newbot<br> 3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Frequency Scanner Chat Bot")<br> 4. –í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞ (–¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ "bot", –Ω–∞–ø—Ä–∏–º–µ—Ä: "frequency_scanner_bot")<br> 5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω (—Ñ–æ—Ä–º–∞—Ç: 123456789:AAHxxxxxxxxxxxxxxxx)<br><br> <strong>üì¢ –ì–¥–µ –≤–∑—è—Ç—å –∫–∞–Ω–∞–ª –¥–ª—è —á–∞—Ç–∞ - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:</strong><br><br> <strong>–í–∞—Ä–∏–∞–Ω—Ç 1: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª</strong><br> 1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –∏–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ<br> 2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–Ω–∞—á–æ–∫ "+" –∏–ª–∏ "–ù–æ–≤—ã–π" –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É<br> 3. –í—ã–±–µ—Ä–∏—Ç–µ "–ù–æ–≤—ã–π –∫–∞–Ω–∞–ª"<br> 4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:<br> &nbsp;&nbsp;&nbsp;‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ: "Frequency Scanner Chat"<br> &nbsp;&nbsp;&nbsp;‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ: "–ß–∞—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Frequency Scanner"<br> 5. –ù–∞–∂–º–∏—Ç–µ "–î–∞–ª–µ–µ"<br> 6. –í—ã–±–µ—Ä–∏—Ç–µ "–ü—É–±–ª–∏—á–Ω—ã–π –∫–∞–Ω–∞–ª"<br> 7. –ü—Ä–∏–¥—É–º–∞–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: frequency_scanner_chat)<br> 8. –ù–∞–∂–º–∏—Ç–µ "–ì–æ—Ç–æ–≤–æ"<br><br> <strong>–í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–∞–Ω–∞–ª</strong><br> 1. –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∫–∞–Ω–∞–ª - –æ—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ<br> 2. –ó–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–∞–ª–∞ (—Ç—Ä–∏ —Ç–æ—á–∫–∏ ‚Üí "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–º")<br> 3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–Ω–∞–ª –ø—É–±–ª–∏—á–Ω—ã–π<br> 4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É (–æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–∞ t.me/–≤–∞—à–µ_–Ω–∞–∑–≤–∞–Ω–∏–µ)<br><br> <strong>üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞ –≤ –∫–∞–Ω–∞–ª:</strong><br> 1. –ó–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ –∫–∞–Ω–∞–ª–∞<br> 2. –í—ã–±–µ—Ä–∏—Ç–µ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã"<br> 3. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"<br> 4. –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –ø–æ username (–∫–æ—Ç–æ—Ä—ã–π –≤—ã —Å–æ–∑–¥–∞–ª–∏ —á–µ—Ä–µ–∑ @BotFather)<br> 5. –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –∏ –¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞:<br> &nbsp;&nbsp;&nbsp;‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π<br> &nbsp;&nbsp;&nbsp;‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π<br> &nbsp;&nbsp;&nbsp;‚úÖ –ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π<br><br> <strong>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∫–æ–¥–µ:</strong><br> –ó–∞–º–µ–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ noninput.html —Å—Ç—Ä–æ–∫–∏:<br> <code style="background: #f5f5f5; padding: 2px;"> botToken: '–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê',<br> chatId: '@–≤–∞—à–∞_—Å—Å—ã–ª–∫–∞_–∫–∞–Ω–∞–ª–∞' </code><br><br> <strong>üìù –ü—Ä–∏–º–µ—Ä—ã –≥–æ—Ç–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</strong><br> ‚Ä¢ @InputlagTest - —Ç–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤<br> ‚Ä¢ @frequency_scanner_demo - –¥–µ–º–æ –∫–∞–Ω–∞–ª (–º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–Ω—è—Ç)<br> ‚Ä¢ @your_app_chat - —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª<br><br> <strong>üí° –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:</strong><br> ‚Ä¢ –ö–∞–Ω–∞–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å <u>–ø—É–±–ª–∏—á–Ω—ã–º</u> (–Ω–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º)<br> ‚Ä¢ –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∫–∞–Ω–∞–ª–∞<br> ‚Ä¢ –í chatId –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ @ –ø–µ—Ä–µ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º: '@–≤–∞—à_–∫–∞–Ω–∞–ª'<br> ‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –≤ Telegram<br> ‚Ä¢ –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —Ü–∏—Ñ—Ä—ã: '@my_chat_2024'<br><br> <strong>üÜö –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –≤–º–µ—Å—Ç–æ –∫–∞–Ω–∞–ª–∞</strong><br> –ï—Å–ª–∏ –∫–∞–Ω–∞–ª –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—É—é –≥—Ä—É–ø–ø—É:<br> 1. –°–æ–∑–¥–∞–π—Ç–µ "–ù–æ–≤—É—é –≥—Ä—É–ø–ø—É" –≤–º–µ—Å—Ç–æ –∫–∞–Ω–∞–ª–∞<br> 2. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É<br> 3. –°–¥–µ–ª–∞–π—Ç–µ –≥—Ä—É–ø–ø—É –ø—É–±–ª–∏—á–Ω–æ–π (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –¢–∏–ø –≥—Ä—É–ø–ø—ã ‚Üí –ü—É–±–ª–∏—á–Ω–∞—è)<br> 4. –ü–æ–ª—É—á–∏—Ç–µ chat_id –≥—Ä—É–ø–ø—ã:<br> &nbsp;&nbsp;&nbsp;‚Ä¢ –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É<br> &nbsp;&nbsp;&nbsp;‚Ä¢ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: https: &nbsp;&nbsp;&nbsp;‚Ä¢ –ù–∞–π–¥–∏—Ç–µ "chat":{"id":-—á–∏—Å–ª–æ–≤–æ–π_id} –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ —á–∏—Å–ª–æ<br><br> <strong>üîç –ï–°–õ–ò –ù–ï –ü–û–î–ö–õ–Æ–ß–ê–ï–¢–°–Ø - –ü–†–û–í–ï–†–¨–¢–ï:</strong><br><br> <strong style="color: #d32f2f;">‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Telegram"</strong><br> <strong>–†–µ—à–µ–Ω–∏–µ:</strong><br> 1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Telegram" –≤—ã—à–µ<br> 2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫–∏<br> 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–æ—Ç @Inputlagthebot –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /start<br><br> <strong style="color: #d32f2f;">‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "–ë–æ—Ç –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ –∫–∞–Ω–∞–ª"</strong><br> <strong>–†–µ—à–µ–Ω–∏–µ:</strong><br> 1. –û—Ç–∫—Ä–æ–π—Ç–µ <a href="https: 2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ ‚Üí "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–º"<br> 3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã"<br> 4. –î–æ–±–∞–≤—å—Ç–µ @Inputlagthebot —Å –ø—Ä–∞–≤–∞–º–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π<br><br> <strong style="color: #d32f2f;">‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "–ö–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"</strong><br> <strong>–†–µ—à–µ–Ω–∏–µ:</strong><br> 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–∞–Ω–∞–ª @noninput —Å—É—â–µ—Å—Ç–≤—É–µ—Ç<br> 2. –ö–∞–Ω–∞–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω—ã–º (–Ω–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º)<br> 3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª –∏ –æ–±–Ω–æ–≤–∏—Ç—å chatId –≤ –∫–æ–¥–µ<br><br> <small style="color: #4CAF50;">‚úÖ <strong>–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ:</strong> –ë–æ—Ç @Inputlagthebot ‚Üí –ö–∞–Ω–∞–ª t.me/noninput</small> </div> </details> </div> <div class="username-input"> <input type="text" id="usernameInput" placeholder="–í–∞—à–µ –∏–º—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" maxlength="20"> </div> <div class="message-count"> –°–æ–æ–±—â–µ–Ω–∏–π: <span id="messageCount">0</span> </div> <div class="chat-messages" id="chatMessages"> <div class="message system"> <div>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —á–∞—Ç! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –æ–±—â–∞—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ Frequency Scanner.</div> <div class="message-meta">–°–∏—Å—Ç–µ–º–∞ ‚Ä¢ —Å–µ–π—á–∞—Å</div> </div> </div> <div class="chat-input"> <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="200"> <button id="sendButton">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button> </div> </div> </div> <!-- ====== –û–ü–ò–°–ê–ù–ò–Ø (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å) ====== --> <section id="how-it-works" style="max-width:960px;margin:24px auto;padding:18px 20px;background:#fff;border-radius:16px;box-shadow:0 2px 22px rgba(0,0,0,.07);font:14px/1.55 system-ui,Segoe UI,Arial"> <h2 style="margin:0 0 12px">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h2> <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑–º–µ—Ä—è–µ—Ç ¬´–º–∏–∫—Ä–æ–¥—Ä–æ–∂–∞–Ω–∏–µ¬ª CPU, –∏–∑–≤–ª–µ–∫–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—ã (Goertzel), —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–∑—É (Kalman) –∏ –æ–Ω–ª–∞–π–Ω–æ–≤–æ–π –º–∏–Ω–∏-–Ω–µ–π—Ä–æ—Å–µ—Ç—å—é –ø–æ–¥–±–∏—Ä–∞–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å —Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞, —Å—Ç—Ä–µ–º—è—Å—å –∫ <b>J‚Üí0</b>. –í—Å—Ç—Ä–æ–µ–Ω–∞ lock-–∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.</p> </section> <section id="use-cases" style="max-width:960px;margin:24px auto;padding:18px 20px;background:#fff;border-radius:16px;box-shadow:0 2px 22px rgba(0,0,0,.07);font:14px/1.55 system-ui,Segoe UI,Arial"> <h2 style="margin:0 0 12px">–ì–¥–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å</h2> <ul style="margin:6px 0 0 18px"> <li>–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–æ–≤/–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–º–µ–Ω—å—à–µ –¥–∂–∏—Ç—Ç–µ—Ä–∞ ‚Üí –º–µ–Ω—å—à–µ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–ø–ª–∞).</li> <li>–ú—É–ª—å—Ç–∏–º–µ–¥–∏–∞/–∏–≥—Ä—ã: —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –ª–∞–≥–æ–≤ –∏ –∞–≤—Ç–æ–ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –∫ —Ç–∏–∫—Ä–µ–π—Ç—É.</li> <li>–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞/–§–ê–ü–ß/–®–ò–ú: –æ–Ω–ª–∞–π–Ω-–ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.</li> </ul> </section> <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ù–ï–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô —Ä—É—á–Ω–æ–π —Ä–µ–∫–ª–∞–º–Ω—ã–π –±–ª–æ–∫ –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Responsive) –ó–∞–º–µ–Ω–∏ data-ad-slot –Ω–∞ —Å–≤–æ–π. –î–ª—è Auto Ads —ç—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ. <ins class="adsbygoogle ad-placeholder" data-ad-client="ca-pub-1128500581050725" data-ad-slot="REPLACE_WITH_YOUR_SLOT_ID_2" data-ad-format="auto" data-full-width-responsive="true"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ --> <script> class MultiUserChatSystem { constructor() { this.messages = []; this.badWords = this.initBadWordsFilter(); this.username = ''; this.userId = this.generateUserId(); this.onlineUsers = new Set(); this.lastActivity = Date.now(); this.initFirebase(); this.updateMessageCount(); } initFirebase() { console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±–ª–∞—á–Ω–æ–≥–æ —á–∞—Ç–∞'); this.initCloudChat(); } initCloudChat() { console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram —á–∞—Ç–∞'); this._03pd05wz = { botToken: 'REDACTED_FOR_SECURITY', // –ü–æ–ª—É—á–∞–π—Ç–µ —Ç–æ–∫–µ–Ω —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è TELEGRAM_BOT_TOKEN apiUrl: 'https: pollInterval: 2000, maxRetries: 3, retryDelay: 1000, timeout: 10000, healthCheckInterval: 30000 }; this.connectionState = { isConnected: false, lastSuccessfulRequest: 0, consecutiveFailures: 0, maxConsecutiveFailures: 5, reconnectAttempts: 0, maxReconnectAttempts: 10 }; this.proxyUrls = [ 'https: 'https: 'https: '', ]; this.currentProxyIndex = 0; this.initTelegramConnection(); } async initTelegramConnection() { try { console.log('üîÑ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram Bot API...'); console.log('üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:', { botToken: this._03pd05wz.botToken.substring(0, 20) + '...', chatId: this._03pd05wz.chatId, proxyUrls: this.proxyUrls.length + ' –ø—Ä–æ–∫—Å–∏ –¥–æ—Å—Ç—É–ø–Ω–æ' }); console.log('üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞:', this._03pd05wz.botToken); console.log('üåê –ü—Ä—è–º–æ–π URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:', `https: if (this._03pd05wz.botToken === '–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê') { console.error('‚ùå –¢–û–ö–ï–ù –ù–ï –ù–ê–°–¢–†–û–ï–ù! –ó–∞–º–µ–Ω–∏—Ç–µ –í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω'); this.updateConnectionStatus('—Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω'); throw new Error('–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω'); } if (this._03pd05wz.chatId === '@–≤–∞—à_–∫–∞–Ω–∞–ª') { console.error('‚ùå –ö–ê–ù–ê–õ –ù–ï –ù–ê–°–¢–†–û–ï–ù! –ó–∞–º–µ–Ω–∏—Ç–µ @–≤–∞—à_–∫–∞–Ω–∞–ª –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª'); this.updateConnectionStatus('–∫–∞–Ω–∞–ª –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω'); throw new Error('–ö–∞–Ω–∞–ª –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω'); } console.log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ'); console.log('üìã –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:', { tokenFormat: this._03pd05wz.botToken.includes(':') ? 'OK' : '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç', channelFormat: this._03pd05wz.chatId.startsWith('@') ? 'OK' : '–î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å @' }); this.updateConnectionStatus('–ø—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞...'); const botInfo = await this.sendTelegramRequest('getMe'); if (botInfo && botInfo.ok) { console.log('‚úÖ Telegram –±–æ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω:', botInfo.result.username); console.log('üì¢ –ö–∞–Ω–∞–ª –¥–ª—è —á–∞—Ç–∞:', this._03pd05wz.chatId); console.log('üîó –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ –∞–¥–º–∏–Ω –≤ –∫–∞–Ω–∞–ª:', 'https: this.updateConnectionStatus('–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–Ω–∞–ª–∞...'); const channelTest = await this.testChannelAccess(); if (channelTest) { this.updateConnectionStatus('–ø–æ–¥–∫–ª—é—á–µ–Ω (Telegram)'); this.loadTelegramMessages(); this.startTelegramPolling(); this.sendWelcomeMessage(); } else { console.warn('‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –∫–∞–Ω–∞–ª—É'); this.updateConnectionStatus('–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É'); setTimeout(() => { console.log('üí° –ù–∞–∂–º–∏—Ç–µ "üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Telegram" –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º'); }, 3000); } } else { console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–æ—Ç—É:', botInfo); this.updateConnectionStatus('–æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–æ—Ç—É'); if (botInfo?.error_code === 401) { console.error('üîë –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞'); this.updateConnectionStatus('–Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω'); } else if (botInfo?.error_code === 404) { console.error('üö´ –ë–æ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω'); this.updateConnectionStatus('–±–æ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω'); } throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Telegram –±–æ—Ç—É: ' + (botInfo?.description || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞')); } } catch (error) { console.error('üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ Telegram –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:', error); console.log('üîß –ü—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:'); if (error.message.includes('Failed to fetch')) { console.log('üåê –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ - –≤—Å–µ –ø—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã'); console.log('üí° –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ'); this.updateConnectionStatus('—Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞'); } else if (error.message.includes('401')) { console.log('üîë –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞'); console.log('üí° –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ @BotFather'); this.updateConnectionStatus('–Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω'); } else if (error.message.includes('404')) { console.log('üö´ –ë–æ—Ç –∏–ª–∏ –∫–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω'); console.log('üí° –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ @Inputlagthebot –∏ @noninput'); this.updateConnectionStatus('–Ω–µ –Ω–∞–π–¥–µ–Ω'); } else { console.log('‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'); console.log('üí° –†–µ—à–µ–Ω–∏–µ: –ù–∞–∂–º–∏—Ç–µ "üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Telegram"'); this.updateConnectionStatus('–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'); } this.fallbackToLocal(); } } async testChannelAccess() { try { console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª—É...'); const testMessage = await this.sendTelegramRequest('sendMessage', { chat_id: this._03pd05wz.chatId, text: 'üîß –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è - ' + new Date().toLocaleTimeString() }); if (testMessage && testMessage.ok) { console.log('‚úÖ –î–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª—É —Ä–∞–±–æ—Ç–∞–µ—Ç'); return true; } else { console.warn('‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –∫–∞–Ω–∞–ª—É:', testMessage); console.log('üí° –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:'); console.log('- –ö–∞–Ω–∞–ª @noninput —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –ø—É–±–ª–∏—á–Ω—ã–π'); console.log('- –ë–æ—Ç @Inputlagthebot –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'); console.log('- –£ –±–æ—Ç–∞ –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π'); if (testMessage?.error_code === 403) { console.error('üö´ –ë–æ—Ç –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –≤ –∫–∞–Ω–∞–ª'); } else if (testMessage?.error_code === 400) { console.error('üìù –ö–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π chat_id'); } return false; } } catch (error) { console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª:', error); return false; } } async sendTelegramRequest(method, params = {}) { console.log(`üåê –û—Ç–ø—Ä–∞–≤–∫–∞ Telegram –∑–∞–ø—Ä–æ—Å–∞: ${method}`, params); for (let attempt = 1; attempt <= this._03pd05wz.maxRetries; attempt++) { console.log(`üîÑ –ü–æ–ø—ã—Ç–∫–∞ ${attempt}/${this._03pd05wz.maxRetries}`); for (let i = 0; i < this.proxyUrls.length; i++) { try { const proxyUrl = this.proxyUrls[this.currentProxyIndex]; console.log(`üîÑ –ü—Ä–æ–∫—Å–∏ ${this.currentProxyIndex + 1}/${this.proxyUrls.length}: ${proxyUrl || '–ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ'}`); let url; if (proxyUrl === '') { url = `${this._03pd05wz.apiUrl}${this._03pd05wz.botToken}/${method}`; console.log(`üîó –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram API`); } else if (proxyUrl.includes('allorigins')) { const apiUrl = `${this._03pd05wz.apiUrl}${this._03pd05wz.botToken}/${method}`; url = `${proxyUrl}${encodeURIComponent(apiUrl)}`; } else { url = `${proxyUrl}${this._03pd05wz.apiUrl}${this._03pd05wz.botToken}/${method}`; } const controller = new AbortController(); const timeout = method === 'sendMessage' ? 8000 : this._03pd05wz.timeout; const timeoutId = setTimeout(() => { console.warn(`‚è±Ô∏è –¢–∞–π–º–∞—É—Ç ${timeout}–º—Å –¥–ª—è ${method} —á–µ—Ä–µ–∑ ${proxyUrl || '–ø—Ä—è–º–æ–µ'}`); controller.abort(); }, timeout); const response = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json', 'X-Requested-With': 'XMLHttpRequest' }, body: JSON.stringify(params), signal: controller.signal }); clearTimeout(timeoutId); console.log(`üìä –û—Ç–≤–µ—Ç: ${response.status} ${response.statusText}`); if (!response.ok) { throw new Error(`HTTP ${response.status}: ${response.statusText}`); } let result = await response.json(); if (result.contents) { result = JSON.parse(result.contents); } if (result && result.ok) { console.log(`‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ ${this.currentProxyIndex}:`, result); this.connectionState.isConnected = true; this.connectionState.lastSuccessfulRequest = Date.now(); this.connectionState.consecutiveFailures = 0; this.connectionState.reconnectAttempts = 0; return result; } else { throw new Error(`Telegram API error: ${result?.description || 'Unknown error'}`); } } catch (error) { console.warn(`‚ùå –ü—Ä–æ–∫—Å–∏ ${this.currentProxyIndex} (${this.proxyUrls[this.currentProxyIndex] || '–ø—Ä—è–º–æ–µ'}) –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:`, error.message); this.connectionState.consecutiveFailures++; this.currentProxyIndex = (this.currentProxyIndex + 1) % this.proxyUrls.length; if (i === this.proxyUrls.length - 1) { console.error(`üö® –í—Å–µ –ø—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ –ø–æ–ø—ã—Ç–∫–µ ${attempt}`); if (attempt < this._03pd05wz.maxRetries) { console.log(`‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ ${this._03pd05wz.retryDelay}–º—Å –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–æ–π...`); await new Promise(resolve => setTimeout(resolve, this._03pd05wz.retryDelay * attempt)); } } } } } this.connectionState.isConnected = false; console.error('üö® –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏—Å—á–µ—Ä–ø–∞–Ω—ã!'); if (this.connectionState.consecutiveFailures >= this.connectionState.maxConsecutiveFailures) { console.warn('‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º.'); this.fallbackToLocal(); } return null; } async loadTelegramMessages() { try { console.log('üì• –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram –∫–∞–Ω–∞–ª–∞...'); const updates = await this.sendTelegramRequest('getUpdates', { limit: 100, timeout: 0 }); if (updates && updates.ok) { console.log(`üì¨ –ü–æ–ª—É—á–µ–Ω–æ ${updates.result.length} –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π`); const telegramMessages = updates.result .filter(update => { return update.channel_post && update.channel_post.chat && update.channel_post.chat.username === 'noninput' && update.channel_post.text; }) .map(update => ({ id: 'tg_' + update.channel_post.message_id, text: update.channel_post.text, username: update.channel_post.author_signature || 'Telegram User', userId: 'tg_' + (update.channel_post.from?.id || 'channel'), timestamp: update.channel_post.date * 1000, isCurrentUser: false, wasFiltered: false, source: 'telegram' })); console.log(`üí¨ –ù–∞–π–¥–µ–Ω–æ ${telegramMessages.length} —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–∞–Ω–∞–ª–∞`); telegramMessages.forEach(tgMsg => { if (!this.messages.find(existing => existing.id === tgMsg.id)) { this.messages.push(tgMsg); } }); this.messages.sort((a, b) => a.timestamp - b.timestamp); this.messages = this.messages.slice(-50); this.updateMessageCount(); this.renderMessages(); console.log(`‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: ${telegramMessages.length}`); } else { console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', updates); } } catch (error) { console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π Telegram:', error); } } startTelegramPolling() { if (this.telegramPollInterval) { clearInterval(this.telegramPollInterval); } if (this.healthCheckInterval) { clearInterval(this.healthCheckInterval); } console.log('üîÑ –ó–∞–ø—É—Å–∫ Telegram polling —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º', this._03pd05wz.pollInterval, '–º—Å'); this.telegramPollInterval = setInterval(() => { this.checkTelegramUpdates(); }, this._03pd05wz.pollInterval); this.healthCheckInterval = setInterval(() => { this.performHealthCheck(); }, this._03pd05wz.healthCheckInterval); console.log('‚úÖ Telegram polling –∑–∞–ø—É—â–µ–Ω'); } async performHealthCheck() { console.log('üè• –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è Telegram —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...'); const timeSinceLastSuccess = Date.now() - this.connectionState.lastSuccessfulRequest; if (timeSinceLastSuccess > this._03pd05wz.healthCheckInterval * 2) { console.warn('‚ö†Ô∏è –î–æ–ª–≥–æ –Ω–µ –±—ã–ª–æ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram'); this.updateConnectionStatus('–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...'); const healthCheck = await this.sendTelegramRequest('getMe'); if (healthCheck && healthCheck.ok) { console.log('‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Telegram –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'); this.updateConnectionStatus('–ø–æ–¥–∫–ª—é—á–µ–Ω (Telegram)'); } else { console.error('‚ùå Health check failed'); this.connectionState.reconnectAttempts++; if (this.connectionState.reconnectAttempts >= this.connectionState.maxReconnectAttempts) { console.error('üö® –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º.'); this.fallbackToLocal(); } else { console.log('üîÑ –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...'); this.retryTelegramConnection(); } } } else { console.log('‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ'); } } async checkTelegramUpdates() { try { console.log('üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram...'); const lastUpdateId = parseInt(localStorage.getItem('lastTelegramUpdateId') || '0'); const updates = await this.sendTelegramRequest('getUpdates', { offset: lastUpdateId + 1, limit: 100, timeout: 10, allowed_updates: ['message', 'channel_post', 'edited_message', 'edited_channel_post'] }); if (updates && updates.ok) { console.log(`üì® –ü–æ–ª—É—á–µ–Ω–æ ${updates.result.length} –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏–∑ Telegram`); let newMessagesCount = 0; updates.result.forEach(update => { localStorage.setItem('lastTelegramUpdateId', update.update_id.toString()); let message = null; console.log('üîç –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', { update_id: update.update_id, type: Object.keys(update).filter(key => key !== 'update_id'), content: update }); if (update.channel_post && (update.channel_post.chat.username === 'noninput' || update.channel_post.chat.id === -1002360087823)) { console.log('üì° –°–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞ @noninput'); message = { id: 'tg_ch_' + update.channel_post.message_id, text: update.channel_post.text || '[–ú–µ–¥–∏–∞]', username: update.channel_post.author_signature || (update.channel_post.from ? update.channel_post.from.first_name : '–ö–∞–Ω–∞–ª'), userId: 'channel_' + update.channel_post.chat.id, timestamp: update.channel_post.date * 1000, isCurrentUser: false, wasFiltered: false, source: 'telegram_channel' }; } else if (update.message && (update.message.chat.username === 'noninput' || update.message.chat.id === -1002360087823)) { console.log('üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –≥—Ä—É–ø–ø—ã @noninput'); if (update.message.from.id === 8223995698) { console.log('ü§ñ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–æ—Ç–∞'); return; } message = { id: 'tg_grp_' + update.message.message_id, text: update.message.text || '[–ú–µ–¥–∏–∞]', username: update.message.from.first_name + (update.message.from.last_name ? ' ' + update.message.from.last_name : '') || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', userId: 'tg_' + update.message.from.id, timestamp: update.message.date * 1000, isCurrentUser: false, wasFiltered: false, source: 'telegram_group' }; } else if (update.message && update.message.chat.type === 'private' && update.message.text) { console.log('üì± –ü—Ä–∏–≤–∞—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É'); message = { id: 'tg_prv_' + update.message.message_id, text: update.message.text, username: update.message.from.first_name + (update.message.from.last_name ? ' ' + update.message.from.last_name : '') || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', userId: 'tg_' + update.message.from.id, timestamp: update.message.date * 1000, isCurrentUser: false, wasFiltered: false, source: 'telegram_private' }; } if (message && !this.messages.find(existing => existing.id === message.id)) { this.messages.push(message); newMessagesCount++; console.log(`‚ûï –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ [${message.source}]: ${message.username}: ${message.text.substring(0, 50)}...`); } }); if (newMessagesCount > 0) { console.log(`‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ ${newMessagesCount} –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π`); this.messages.sort((a, b) => a.timestamp - b.timestamp); this.messages = this.messages.slice(-50); this.updateMessageCount(); this.renderMessages(); this.showActiveUsers(); } else if (updates.result.length > 0) { console.log('‚ÑπÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã, –Ω–æ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç'); } } else { console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', updates); } } catch (error) { console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π Telegram:', error); } } async sendMessageToTelegram(text, username = null) { try { const currentUsername = username || document.getElementById('usernameInput')?.value.trim() || '–ê–Ω–æ–Ω–∏–º–Ω—ã–π'; const timestamp = new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' }); const formattedMessage = `üí¨ <b>${currentUsername}</b> (${timestamp}): ${text} üì± <i>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ Frequency Scanner</i>`; console.log('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –∫–∞–Ω–∞–ª:', { channel: this._03pd05wz.chatId, user: currentUsername, message: text.substring(0, 50) + '...' }); this.updateConnectionStatus('–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è...'); const result = await this.sendTelegramRequest('sendMessage', { chat_id: this._03pd05wz.chatId, text: formattedMessage, parse_mode: 'HTML' }); if (result && result.ok) { console.log('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram –∫–∞–Ω–∞–ª'); console.log('üîó –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: https: this.updateConnectionStatus('–ø–æ–¥–∫–ª—é—á–µ–Ω (Telegram)'); return true; } else { console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram:', result); if (result && result.error_code === 403) { console.error('üö´ –ë–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –≤ –∫–∞–Ω–∞–ª'); this.updateConnectionStatus('–Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞'); } else if (result && result.error_code === 400) { console.error('üìù –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ –∫–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω'); this.updateConnectionStatus('–æ—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞'); } else { this.updateConnectionStatus('–ø–æ–¥–∫–ª—é—á–µ–Ω (Telegram)'); } return false; } } catch (error) { console.error('üö® –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error); if (error.name === 'AbortError') { console.warn('‚è±Ô∏è –¢–∞–π–º–∞—É—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è'); this.updateConnectionStatus('—Ç–∞–π–º–∞—É—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏'); } else if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) { console.warn('üåê –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ'); this.updateConnectionStatus('—Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞'); } else { this.updateConnectionStatus('–ø–æ–¥–∫–ª—é—á–µ–Ω (Telegram)'); } return false; } } async sendWelcomeMessage() { const welcomeText = `üéµ –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ Frequency Scanner —á–∞—Ç—É! üîó Telegram –∫–∞–Ω–∞–ª: t.me/noninput ü§ñ –ë–æ—Ç: @Inputlagthebot üìä –ß–∞—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç!`; await this.sendMessageToTelegram(welcomeText); } loadSharedMessages() { try { const sharedData = localStorage.getItem(this.sharedKey); if (sharedData) { const parsed = JSON.parse(sharedData); this.messages = parsed.messages || []; this.lastSyncTime = parsed.lastUpdate || 0; } else { this.messages = []; this.initializeSharedChat(); } this.updateMessageCount(); this.renderMessages(); console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –æ–±—â–µ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:', this.messages.length); } catch (error) { console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:', error); this.messages = []; } } initializeSharedChat() { const welcomeMessages = [ { id: 'welcome_1', text: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —á–∞—Ç Frequency Scanner! üéâ', username: '–°–∏—Å—Ç–µ–º–∞', userId: 'system', timestamp: Date.now() - 10000, isCurrentUser: false, wasFiltered: false }, { id: 'welcome_2', text: '–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –æ–±—Å—É–∂–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –∏ –¥–µ–ª–∏—Ç—å—Å—è –æ–ø—ã—Ç–æ–º', username: '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä', userId: 'moderator', timestamp: Date.now() - 5000, isCurrentUser: false, wasFiltered: false } ]; this.messages = welcomeMessages; this.saveSharedMessages(); } saveSharedMessages() { try { const sharedData = { messages: this.messages.slice(-100), lastUpdate: Date.now(), userCount: this.getUserCount() }; localStorage.setItem(this.sharedKey, JSON.stringify(sharedData)); this.lastSyncTime = sharedData.lastUpdate; window.dispatchEvent(new StorageEvent('storage', { key: this.sharedKey, newValue: JSON.stringify(sharedData) })); console.log('–°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –æ–±—â–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ'); return true; } catch (error) { console.warn('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π:', error); return false; } } checkForUpdates() { try { const sharedData = localStorage.getItem(this.sharedKey); if (sharedData) { const parsed = JSON.parse(sharedData); if (parsed.lastUpdate > this.lastSyncTime) { console.log('–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è'); const newMessages = parsed.messages || []; newMessages.forEach(msg => { if (!this.messages.find(existing => existing.id === msg.id)) { this.messages.push({ ...msg, isCurrentUser: msg.userId === this.userId }); } }); this.messages.sort((a, b) => a.timestamp - b.timestamp); this.messages = this.messages.slice(-50); this.lastSyncTime = parsed.lastUpdate; this.updateMessageCount(); this.renderMessages(); } } this.showActiveUsers(); } catch (error) { console.warn('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:', error); } } simulateMultiUserActivity() { const demoUsers = ['–ê–ª–µ–∫—Å–µ–π', '–ú–∞—Ä–∏—è', '–î–º–∏—Ç—Ä–∏–π', '–ê–Ω–Ω–∞', '–°–µ—Ä–≥–µ–π']; const demoMessages = [ '–ß–∞—Å—Ç–æ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã!', '–ö—Ç–æ-–Ω–∏–±—É–¥—å –ø—Ä–æ–±–æ–≤–∞–ª –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ö–∞–ª–º–∞–Ω–∞?', '–ù–µ–π—Ä–æ-–≥–æ–º–µ–æ—Å—Ç–∞–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—á–µ–Ω—å —Å—Ç–∞–±–∏–ª—å–Ω–æ üëç', '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ', '–•–æ—Ä–æ—à–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö!', '–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –Ω–∞–≥—Ä—É–∑–∫–µ' ]; setTimeout(() => { if (Math.random() < 0.3) { const randomUser = demoUsers[Math.floor(Math.random() * demoUsers.length)]; const randomMessage = demoMessages[Math.floor(Math.random() * demoMessages.length)]; this.addSimulatedMessage(randomMessage, randomUser); } this.simulateMultiUserActivity(); }, Math.random() * 30000 + 15000); } addSimulatedMessage(text, username) { const message = { id: 'sim_' + Date.now() + '_' + Math.random(), text: text, username: username, userId: 'simulated_' + username, timestamp: Date.now(), isCurrentUser: false, wasFiltered: false }; this.messages.push(message); this.saveSharedMessages(); this.updateMessageCount(); this.renderMessages(); } getUserCount() { const uniqueUsers = new Set(); this.messages.forEach(msg => { if (msg.source === 'telegram') { uniqueUsers.add(msg.userId); } }); uniqueUsers.add(this.userId); if (this._03pd05wz && !this.isLocalMode) { return Math.max(uniqueUsers.size, 2) + Math.floor(Math.random() * 3); } return Math.floor(Math.random() * 8) + 2; } showActiveUsers() { const userCountElement = document.getElementById('userCount'); if (userCountElement) { const activeUsers = this.getUserCount(); const lastActivity = localStorage.getItem('chatLastActivity'); const now = Date.now(); const recentActivity = lastActivity && (now - parseInt(lastActivity)) < 120000; const displayCount = recentActivity ? Math.max(activeUsers, 3) : activeUsers; userCountElement.textContent = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω: ${displayCount}`; userCountElement.style.color = displayCount > 2 ? '#4CAF50' : '#9e9e9e'; } } simulateUserActivity() { localStorage.setItem('chatLastActivity', Date.now().toString()); this.showActiveUsers(); } async checkChannelAccess() { console.log('üì¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É @noninput...'); const modal = document.createElement('div'); modal.style.cssText = ` position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; justify-content: center; align-items: center; padding: 20px; `; const content = document.createElement('div'); content.style.cssText = ` background: white; border-radius: 10px; padding: 20px; max-width: 600px; max-height: 80vh; overflow-y: auto; font-family: monospace; font-size: 12px; line-height: 1.4; `; content.innerHTML = ` <h3>üì¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É</h3> <div id="channelResults">‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª—É @noninput...</div> <button onclick="this.closest('[style*=fixed]').remove()" style="margin-top: 15px; padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;"> –ó–∞–∫—Ä—ã—Ç—å </button> `; modal.appendChild(content); document.body.appendChild(modal); const resultsDiv = content.querySelector('#channelResults'); try { resultsDiv.innerHTML = ` <div style="margin-bottom: 10px;"> üéØ <strong>–¶–µ–ª—å:</strong> –ö–∞–Ω–∞–ª @noninput<br> üîó <strong>–°—Å—ã–ª–∫–∞:</strong> <a href="https: ü§ñ <strong>–ë–æ—Ç:</strong> @Inputlagthebot </div> <div>‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è...</div> `; const testMessage = `üß™ –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É - ${new Date().toLocaleString()}`; console.log('üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:', testMessage); const result = await this.sendTelegramRequest('sendMessage', { chat_id: this._03pd05wz.chatId, text: testMessage }); if (result && result.ok) { resultsDiv.innerHTML = ` <div style="color: #4CAF50; font-weight: bold; margin-bottom: 15px;"> ‚úÖ –î–û–°–¢–£–ü –ö –ö–ê–ù–ê–õ–£ –ï–°–¢–¨! </div> <div style="background: #e8f5e8; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>üéâ –û—Ç–ª–∏—á–Ω–æ!</strong> –ë–æ—Ç –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª @noninput<br><br> <strong>üìã –î–µ—Ç–∞–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏:</strong><br> ‚Ä¢ <strong>ID —Å–æ–æ–±—â–µ–Ω–∏—è:</strong> ${result.result.message_id}<br> ‚Ä¢ <strong>–î–∞—Ç–∞:</strong> ${new Date(result.result.date * 1000).toLocaleString()}<br> ‚Ä¢ <strong>Chat ID:</strong> ${result.result.chat.id}<br> ‚Ä¢ <strong>–¢–∏–ø —á–∞—Ç–∞:</strong> ${result.result.chat.type} </div> <div style="background: #f0f0f0; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>üîó –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–Ω–∞–ª:</strong><br> –û—Ç–∫—Ä–æ–π—Ç–µ <a href="https: </div> <div style="background: #fff3cd; padding: 10px; border-radius: 5px;"> <strong>‚úÖ –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!</strong><br> –ï—Å–ª–∏ —á–∞—Ç –≤—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É", –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:<br> 1. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)<br> 2. –ù–∞–∂–∞—Ç—å "üîÑ –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Telegram"<br> 3. –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ </div> `; console.log('‚úÖ –î–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª—É —Ä–∞–±–æ—Ç–∞–µ—Ç:', result); } else { const errorCode = result?.error_code || 'unknown'; const errorDesc = result?.description || 'Unknown error'; let errorExplanation = ''; let solution = ''; switch(errorCode) { case 403: errorExplanation = '–ë–æ—Ç –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–∞–Ω–∞–ª'; solution = ` 1. –û—Ç–∫—Ä–æ–π—Ç–µ <a href="https: 2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –≤–≤–µ—Ä—Ö—É<br> 3. –í—ã–±–µ—Ä–∏—Ç–µ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–º"<br> 4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã"<br> 5. –ù–∞–π–¥–∏—Ç–µ @Inputlagthebot –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ<br> 6. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É –±–æ—Ç–∞ –µ—Å—Ç—å –ø—Ä–∞–≤–∞:<br> &nbsp;&nbsp;&nbsp;‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π<br> &nbsp;&nbsp;&nbsp;‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–Ω–∞–ª–∞<br> &nbsp;&nbsp;&nbsp;‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π `; break; case 400: if (errorDesc.includes('not found')) { errorExplanation = '–ö–∞–Ω–∞–ª @noninput –Ω–µ –Ω–∞–π–¥–µ–Ω'; solution = ` 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–∞–Ω–∞–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: <a href="https: 2. –ö–∞–Ω–∞–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω—ã–º (–Ω–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º)<br> 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è: @noninput<br> 4. –ï—Å–ª–∏ –∫–∞–Ω–∞–ª–∞ –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –≤ Telegram `; } else { errorExplanation = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç chat_id –∏–ª–∏ –¥—Ä—É–≥–∞—è –æ—à–∏–±–∫–∞'; solution = '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ chat_id —É–∫–∞–∑–∞–Ω –∫–∞–∫ @noninput'; } break; default: errorExplanation = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ API'; solution = '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–æ–≤ Telegram'; } resultsDiv.innerHTML = ` <div style="color: #f44336; font-weight: bold; margin-bottom: 15px;"> ‚ùå –ù–ï–¢ –î–û–°–¢–£–ü–ê –ö –ö–ê–ù–ê–õ–£! </div> <div style="background: #ffebee; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>üö® –û—à–∏–±–∫–∞ API:</strong><br> ‚Ä¢ <strong>–ö–æ–¥ –æ—à–∏–±–∫–∏:</strong> ${errorCode}<br> ‚Ä¢ <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${errorDesc}<br> ‚Ä¢ <strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> ${errorExplanation} </div> <div style="background: #fff3cd; padding: 10px; border-radius: 5px;"> <strong>üîß –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</strong><br> ${solution} </div> `; console.error('‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É:', result); } } catch (error) { console.error('üö® –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–Ω–∞–ª–∞:', error); resultsDiv.innerHTML = ` <div style="color: #f44336; font-weight: bold; margin-bottom: 15px;"> üö® –û–®–ò–ë–ö–ê –ü–†–û–í–ï–†–ö–ò! </div> <div style="background: #ffebee; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>‚ùå –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:</strong><br> ${error.message} </div> <div style="background: #fff3cd; padding: 10px; border-radius: 5px;"> <strong>üí° –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</strong><br> 1. –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º<br> 2. –í—Å–µ –ø—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã<br> 3. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Telegram<br><br> <strong>üîß –ß—Ç–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:</strong><br> ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º<br> ‚Ä¢ –ù–∞–∂–º–∏—Ç–µ "üîÑ –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Telegram"<br> ‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ </div> `; } } async checkBotSettings() { console.log('ü§ñ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞...'); const modal = document.createElement('div'); modal.style.cssText = ` position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; justify-content: center; align-items: center; padding: 20px; `; const content = document.createElement('div'); content.style.cssText = ` background: white; border-radius: 10px; padding: 20px; max-width: 700px; max-height: 80vh; overflow-y: auto; font-family: monospace; font-size: 12px; line-height: 1.4; `; content.innerHTML = ` <h3>ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</h3> <div id="botSettingsResults">‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞...</div> <button onclick="this.closest('[style*=fixed]').remove()" style="margin-top: 15px; padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;"> –ó–∞–∫—Ä—ã—Ç—å </button> `; modal.appendChild(content); document.body.appendChild(modal); const resultsDiv = content.querySelector('#botSettingsResults'); try { const botInfo = await this.sendTelegramRequest('getMe'); let html = ''; if (botInfo && botInfo.ok) { const bot = botInfo.result; const canReadAll = bot.can_read_all_group_messages; html += ` <div style="background: ${canReadAll ? '#e8f5e8' : '#fff3cd'}; padding: 15px; border-radius: 5px; margin-bottom: 15px;"> <h4 style="margin: 0 0 10px 0;">üîê Privacy Mode (–†–µ–∂–∏–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏)</h4> <strong>–ß—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≥—Ä—É–ø–ø—ã:</strong> <span style="font-weight: bold; color: ${canReadAll ? '#4CAF50' : '#FF9800'};"> ${canReadAll ? '‚úÖ –í–ö–õ–Æ–ß–ï–ù–û' : '‚ö†Ô∏è –û–¢–ö–õ–Æ–ß–ï–ù–û'} </span><br><br> ${canReadAll ? '<div style="color: #4CAF50;">‚úÖ <strong>–û—Ç–ª–∏—á–Ω–æ!</strong> –ë–æ—Ç –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –≥—Ä—É–ø–ø—ã @noninput –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ö —Å —Å–∞–π—Ç–æ–º.</div>' : `<div style="color: #FF9800;"> ‚ö†Ô∏è <strong>–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞!</strong> –ë–æ—Ç –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ –µ–º—É (@Inputlagthebot).<br><br> <strong>üîß –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:</strong><br> 1. –û—Ç–∫—Ä–æ–π—Ç–µ <a href="https: 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É <code>/mybots</code><br> 3. –í—ã–±–µ—Ä–∏—Ç–µ <code>@${bot.username}</code><br> 4. –ù–∞–∂–º–∏—Ç–µ <code>Bot Settings</code><br> 5. –ù–∞–∂–º–∏—Ç–µ <code>Group Privacy</code><br> 6. –í—ã–±–µ—Ä–∏—Ç–µ <code>Turn off</code> (–æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å)<br> 7. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è<br><br> <strong>üîÑ –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:</strong><br> ‚Ä¢ –û–±–Ω–æ–≤–∏—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É<br> ‚Ä¢ –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ @noninput<br> ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é </div>` } </div> <div style="text-align: center; margin-top: 15px;"> <button onclick="window.open('https: style="background: #0088cc; color: white; border: none; padding: 10px 20px; margin: 5px; border-radius: 5px; cursor: pointer;"> üì± –û—Ç–∫—Ä—ã—Ç—å @noninput </button> <button onclick="window.open('https: style="background: #ff6b6b; color: white; border: none; padding: 10px 20px; margin: 5px; border-radius: 5px; cursor: pointer;"> ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–æ—Ç–∞ </button> </div> `; } resultsDiv.innerHTML = html; } catch (error) { console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞:', error); resultsDiv.innerHTML = ` <div style="color: #f44336; font-weight: bold; margin-bottom: 15px;"> ‚ùå –û–®–ò–ë–ö–ê –ü–†–û–í–ï–†–ö–ò –ù–ê–°–¢–†–û–ï–ö </div> <div style="background: #ffebee; padding: 10px; border-radius: 5px;"> <strong>–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:</strong><br> ${error.message} </div> `; } } async checkBotToken() { console.log('üîë –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞...'); const token = this._03pd05wz.botToken; console.log('üìã –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–π —Ç–æ–∫–µ–Ω:', token); const modal = document.createElement('div'); modal.style.cssText = ` position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; justify-content: center; align-items: center; padding: 20px; `; const content = document.createElement('div'); content.style.cssText = ` background: white; border-radius: 10px; padding: 20px; max-width: 500px; max-height: 80vh; overflow-y: auto; font-family: monospace; font-size: 12px; line-height: 1.4; `; content.innerHTML = ` <h3>üîë –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞</h3> <div id="tokenResults">‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω...</div> <button onclick="this.closest('[style*=fixed]').remove()" style="margin-top: 15px; padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;"> –ó–∞–∫—Ä—ã—Ç—å </button> `; modal.appendChild(content); document.body.appendChild(modal); const resultsDiv = content.querySelector('#tokenResults'); try { const directUrl = `https: resultsDiv.innerHTML = ` <div style="margin-bottom: 10px;"> üì° <strong>–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–π —Ç–æ–∫–µ–Ω:</strong><br> <code style="background: #f5f5f5; padding: 5px; border-radius: 3px; word-break: break-all;">${token}</code> </div> <div style="margin-bottom: 10px;"> üåê <strong>–ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ API:</strong><br> <a href="${directUrl}" target="_blank" style="color: #1976d2; word-break: break-all;">${directUrl}</a> </div> <div>‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å...</div> `; let botInfo = null; let connectionMethod = ''; console.log('üîÑ –ü–æ–ø—ã—Ç–∫–∞ 1: –ß–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏...'); botInfo = await this.sendTelegramRequest('getMe'); if (botInfo && botInfo.ok) { connectionMethod = '–ß–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥)'; } else { console.log('üîÑ –ü–æ–ø—ã—Ç–∫–∞ 2: –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å...'); try { const response = await fetch(directUrl); botInfo = await response.json(); connectionMethod = '–ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ API'; } catch (corsError) { console.log('‚ùå CORS –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:', corsError.message); } } if (botInfo && botInfo.ok) { const bot = botInfo.result; resultsDiv.innerHTML = ` <div style="color: #4CAF50; font-weight: bold; margin-bottom: 15px;"> ‚úÖ –¢–û–ö–ï–ù –î–ï–ô–°–¢–í–ò–¢–ï–õ–ï–ù! </div> <div style="background: #e8f5e8; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ:</strong><br> ‚Ä¢ <strong>–ò–º—è:</strong> ${bot.first_name}<br> ‚Ä¢ <strong>Username:</strong> @${bot.username}<br> ‚Ä¢ <strong>ID:</strong> ${bot.id}<br> ‚Ä¢ <strong>–ú–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è—Ç—å—Å—è –∫ –≥—Ä—É–ø–ø–∞–º:</strong> ${bot.can_join_groups ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'}<br> ‚Ä¢ <strong>–ú–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è:</strong> ${bot.can_read_all_group_messages ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'}<br> ‚Ä¢ <strong>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º:</strong> ${bot.supports_inline_queries ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'} </div> <div style="background: #f0f0f0; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>üîó –°–ø–æ—Å–æ–± –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong> ${connectionMethod}<br> <strong>üì± –°—Å—ã–ª–∫–∞ –Ω–∞ –±–æ—Ç–∞:</strong> <a href="https: </div> <div style="background: #fff3cd; padding: 10px; border-radius: 5px;"> <strong>‚úÖ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:</strong><br> 1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–Ω–∞–ª <a href="https: 2. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ @${bot.username} –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞<br> 3. –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π<br> 4. –ù–∞–∂–º–∏—Ç–µ "üß™ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–Ω–∞–ª–∞ </div> `; console.log('‚úÖ –¢–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω:', bot); } else { const errorCode = botInfo?.error_code || 'unknown'; const errorDesc = botInfo?.description || 'Unknown error'; resultsDiv.innerHTML = ` <div style="color: #f44336; font-weight: bold; margin-bottom: 15px;"> ‚ùå –¢–û–ö–ï–ù –ù–ï –î–ï–ô–°–¢–í–ò–¢–ï–õ–ï–ù! </div> <div style="background: #ffebee; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>üö® –û—à–∏–±–∫–∞ API:</strong><br> ‚Ä¢ <strong>–ö–æ–¥ –æ—à–∏–±–∫–∏:</strong> ${errorCode}<br> ‚Ä¢ <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${errorDesc} </div> <div style="background: #fff3cd; padding: 10px; border-radius: 5px;"> <strong>üîß –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</strong><br> 1. –û—Ç–∫—Ä–æ–π—Ç–µ <a href="https: 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /mybots<br> 3. –í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞<br> 4. –ù–∞–∂–º–∏—Ç–µ "API Token"<br> 5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω<br> 6. –ó–∞–º–µ–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è </div> `; console.error('‚ùå –¢–æ–∫–µ–Ω –Ω–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω:', botInfo); } } catch (error) { console.error('üö® –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞:', error); resultsDiv.innerHTML = ` <div style="color: #f44336; font-weight: bold; margin-bottom: 15px;"> üö® –û–®–ò–ë–ö–ê –ü–†–û–í–ï–†–ö–ò! </div> <div style="background: #ffebee; padding: 10px; border-radius: 5px; margin-bottom: 10px;"> <strong>‚ùå –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:</strong><br> ${error.message} </div> <div style="background: #fff3cd; padding: 10px; border-radius: 5px;"> <strong>üí° –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</strong><br> 1. –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º<br> 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ CORS (–ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä)<br> 3. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Telegram<br> 4. –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞<br><br> <strong>üîß –ß—Ç–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:</strong><br> ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ<br> ‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å <a href="${directUrl}" target="_blank">—ç—Ç–æ—Ç URL</a> –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ<br> ‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ </div> `; } } showTelegramDiagnostics() { const diagnostics = ` üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê TELEGRAM –ù–ê–°–¢–†–û–ï–ö üìã –¢–ï–ö–£–©–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø: ‚Ä¢ –¢–æ–∫–µ–Ω –±–æ—Ç–∞: ${this._03pd05wz.botToken.substring(0, 20)}... ‚Ä¢ ID –∫–∞–Ω–∞–ª–∞: ${this._03pd05wz.chatId} ‚Ä¢ –°—Ç–∞—Ç—É—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${this.connectionState.isConnected ? '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω' : '‚ùå –û—Ç–∫–ª—é—á–µ–Ω'} ‚Ä¢ –ù–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫: ${this.connectionState.consecutiveFailures} ‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–∫—Å–∏: ${this.proxyUrls[this.currentProxyIndex] || '–ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ'} üîß –ü–û–®–ê–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê –ù–ê–°–¢–†–û–ï–ö: 1Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –ë–û–¢–ê @Inputlagthebot: ‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ https: ‚Ä¢ –ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å" –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start ‚Ä¢ –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å ‚ùå –ï—Å–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç ‚Üí –±–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ —É–¥–∞–ª–µ–Ω 2Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –ö–ê–ù–ê–õ–ê @noninput: ‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ https: ‚Ä¢ –ö–∞–Ω–∞–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –ø—É–±–ª–∏—á–Ω—ã–π ‚ùå –ï—Å–ª–∏ "–∫–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω" ‚Üí –Ω–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –∏–ª–∏ –∫–∞–Ω–∞–ª –ø—Ä–∏–≤–∞—Ç–Ω—ã–π 3Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –ü–†–ê–í –ë–û–¢–ê –í –ö–ê–ù–ê–õ–ï: ‚Ä¢ –ó–∞–π–¥–∏—Ç–µ –≤ –∫–∞–Ω–∞–ª https: ‚Ä¢ –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –≤–≤–µ—Ä—Ö—É ‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–º" ‚Ä¢ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã" ‚Ä¢ –ù–∞–π–¥–∏—Ç–µ @Inputlagthebot –≤ —Å–ø–∏—Å–∫–µ ‚ùå –ï—Å–ª–∏ –±–æ—Ç–∞ –Ω–µ—Ç ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ 4Ô∏è‚É£ –ù–ê–°–¢–†–û–ô–ö–ê –ü–†–ê–í –ë–û–¢–ê: ‚Ä¢ –í —Å–ø–∏—Å–∫–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ @Inputlagthebot ‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤–∫–ª—é—á–µ–Ω—ã –ø—Ä–∞–≤–∞: ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–Ω–∞–ª–∞ ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π ‚ùå –ï—Å–ª–∏ –ø—Ä–∞–≤ –Ω–µ—Ç ‚Üí –≤–∫–ª—é—á–∏—Ç–µ –∏—Ö 5Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –¢–û–ö–ï–ù–ê –ë–û–¢–ê: ‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ https: ‚Ä¢ –û—Ç–ø—Ä–∞–≤—å—Ç–µ /mybots ‚Ä¢ –ù–∞–π–¥–∏—Ç–µ Inputlagthebot ‚Ä¢ –ù–∞–∂–º–∏—Ç–µ "API Token" ‚Ä¢ –°—Ä–∞–≤–Ω–∏—Ç–µ —Å: ${this._03pd05wz.botToken} ‚ùå –ï—Å–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Üí –æ–±–Ω–æ–≤–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∫–æ–¥–µ üí° –ë–´–°–¢–†–´–ï –¢–ï–°–¢–´: ‚Ä¢ –ù–∞–∂–º–∏—Ç–µ "üß™ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏" –≤—ã—à–µ ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –æ—à–∏–±–∫–∏ ‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤ –∫–∞–Ω–∞–ª –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ Telegram üåê –ü–†–û–í–ï–†–ö–ê –°–ï–¢–ò: ‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å: https: ‚Ä¢ –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ ‚ùå –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º –∏–ª–∏ —Ç–æ–∫–µ–Ω–æ–º `; const modal = document.createElement('div'); modal.style.cssText = ` position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; justify-content: center; align-items: center; padding: 20px; `; const content = document.createElement('div'); content.style.cssText = ` background: white; border-radius: 10px; padding: 20px; max-width: 600px; max-height: 80vh; overflow-y: auto; font-family: monospace; font-size: 12px; line-height: 1.4; `; content.innerHTML = ` <pre style="white-space: pre-wrap; margin: 0;">${diagnostics}</pre> <button onclick="this.closest('[style*=fixed]').remove()" style="margin-top: 15px; padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;"> –ó–∞–∫—Ä—ã—Ç—å </button> <button onclick="_h6a9htgy.runQuickTests(); this.closest('[style*=fixed]').remove();" style="margin-left: 10px; padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;"> üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã </button> `; modal.appendChild(content); document.body.appendChild(modal); } async runQuickTests() { console.log('üöÄ –ó–∞–ø—É—Å–∫ –±—ã—Å—Ç—Ä—ã—Ö —Ç–µ—Å—Ç–æ–≤ Telegram...'); console.log('1Ô∏è‚É£ –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–æ—Ç—É...'); const botTest = await this.sendTelegramRequest('getMe'); if (botTest && botTest.ok) { console.log('‚úÖ –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç:', botTest.result.username); } else { console.error('‚ùå –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:', botTest); } console.log('2Ô∏è‚É£ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –∫–∞–Ω–∞–ª...'); const messageTest = await this.sendMessageToTelegram('üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç - ' + new Date().toLocaleTimeString(), '–°–∏—Å—Ç–µ–º–∞'); if (messageTest) { console.log('‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –∫–∞–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç'); } else { console.error('‚ùå –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –∫–∞–Ω–∞–ª –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç'); } console.log('3Ô∏è‚É£ –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π...'); await this.loadTelegramMessages(); setTimeout(() => { alert(`üß™ –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã! ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ üì± –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–Ω–∞–ª t.me/noninput –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è üîÑ –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã—à–µ`); }, 2000); } async testTelegramSending() { console.log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram...'); this.updateConnectionStatus('—Ç–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏...'); try { const testMessage = `üß™ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ - ${new Date().toLocaleTimeString()}`; const success = await this.sendMessageToTelegram(testMessage, '–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'); if (success) { alert('‚úÖ –¢–µ—Å—Ç —É—Å–ø–µ—à–µ–Ω! –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram –∫–∞–Ω–∞–ª.'); console.log('‚úÖ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ'); } else { alert('‚ùå –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ—à–µ–ª. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ –∏ –∫–∞–Ω–∞–ª.'); console.error('‚ùå –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ–≤–∞–ª–µ–Ω'); } } catch (error) { console.error('üö® –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error); alert('üö® –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏: ' + error.message); } } async syncTelegramMessages() { console.log('üîÑ –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å Telegram...'); this.updateConnectionStatus('—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...'); try { await this.loadTelegramMessages(); await this.checkTelegramUpdates(); console.log('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞'); this.updateConnectionStatus('–ø–æ–¥–∫–ª—é—á–µ–Ω (Telegram)'); setTimeout(() => { const messageCount = this.messages.filter(m => m.source?.includes('telegram')).length; alert(`üì• –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\n–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${messageCount} —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram.`); }, 500); } catch (error) { console.error('‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error); this.updateConnectionStatus('–æ—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏'); } } async retryTelegramConnection() { console.log('üîÑ –†—É—á–Ω–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram...'); this.updateConnectionStatus('–ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...'); this.currentProxyIndex = 0; if (this.telegramPollInterval) { clearInterval(this.telegramPollInterval); } try { await this.initTelegramConnection(); } catch (error) { console.error('‚ùå –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å:', error); this.fallbackToLocal(); } } fallbackToLocal() { console.log('üì± –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º'); this.isLocalMode = true; this.messages = this.loadLocalMessages(); this.simulateOtherUsers(); this.renderMessages(); this.updateConnectionStatus('–ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º'); } updateConnectionStatus(status) { const statusElement = document.getElementById('connectionStatus'); const stabilityElement = document.getElementById('connectionStability'); if (statusElement) { statusElement.textContent = status; if (stabilityElement && this.connectionState) { const failureRate = this.connectionState.consecutiveFailures; const timeSinceLastSuccess = Date.now() - this.connectionState.lastSuccessfulRequest; let stabilityText = ''; let stabilityColor = '#666'; if (status.includes('–ø–æ–¥–∫–ª—é—á–µ–Ω (Telegram)')) { if (failureRate === 0 && timeSinceLastSuccess < 30000) { stabilityText = 'üü¢ –°—Ç–∞–±–∏–ª—å–Ω–æ'; stabilityColor = '#4CAF50'; } else if (failureRate <= 2) { stabilityText = 'üü° –£–º–µ—Ä–µ–Ω–Ω–æ'; stabilityColor = '#FF9800'; } else { stabilityText = 'üî¥ –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ'; stabilityColor = '#F44336'; } const proxy = this.proxyUrls[this.currentProxyIndex] || '–ø—Ä—è–º–æ–µ'; stabilityText += ` | ${proxy.split('/')[2] || '–ø—Ä—è–º–æ–µ'}`; } stabilityElement.textContent = stabilityText; stabilityElement.style.color = stabilityColor; } const container = statusElement.closest('.online-count'); if (container) { if (status.includes('–ø–æ–¥–∫–ª—é—á–µ–Ω') || status.includes('–æ–Ω–ª–∞–π–Ω')) { container.style.background = '#d4edda'; container.style.borderColor = '#c3e6cb'; container.style.color = '#155724'; } else if (status.includes('–æ—à–∏–±–∫–∞') || status.includes('–ª–æ–∫–∞–ª—å–Ω—ã–π')) { container.style.background = '#f8d7da'; container.style.borderColor = '#f5c6cb'; container.style.color = '#721c24'; } else { container.style.background = '#fff3cd'; container.style.borderColor = '#ffeaa7'; container.style.color = '#856404'; } } } } simulateOtherUsers() { const demoMessages = [ { text: "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ! üëç", username: "–ê–ª–µ–∫—Å–µ–π", timestamp: Date.now() - 300000 }, { text: "–ù–µ–π—Ä–æ-–≥–æ–º–µ–æ—Å—Ç–∞–∑ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è", username: "–ú–∞—Ä–∏—è", timestamp: Date.now() - 180000 }, { text: "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä –ö–∞–ª–º–∞–Ω–∞ –∑–¥–µ—Å—å?", username: "–î–º–∏—Ç—Ä–∏–π", timestamp: Date.now() - 120000 } ]; if (this.messages.length === 0) { setTimeout(() => { demoMessages.forEach((msg, index) => { setTimeout(() => { this.addDemoMessage(msg.text, msg.username, msg.timestamp); }, index * 2000); }); }, 3000); } } addDemoMessage(text, username, timestamp) { const message = { id: Date.now() + Math.random(), text: text, username: username, timestamp: timestamp, isCurrentUser: false, wasFiltered: false }; this.messages.push(message); this.saveLocalMessages(); this.updateMessageCount(); this.renderMessages(); } setupRealtimeListeners() { if (!this.database) return; this.database.ref('chat/messages').on('child_added', (snapshot) => { const message = snapshot.val(); if (message && message.userId !== this.userId) { this.addMessageToUI(message); } }); this.database.ref('chat/online').on('value', (snapshot) => { const online = snapshot.val() || {}; this.updateOnlineCount(Object.keys(online).length); }); } trackOnlineUsers() { if (!this.database) return; const userRef = this.database.ref(`chat/online/${this.userId}`); userRef.set({ username: this.username || '–ê–Ω–æ–Ω–∏–º–Ω—ã–π', timestamp: firebase.database.ServerValue.TIMESTAMP }); userRef.onDisconnect().remove(); setInterval(() => { userRef.update({ timestamp: firebase.database.ServerValue.TIMESTAMP }); }, 30000); } generateUserId() { return 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9); } initBadWordsFilter() { return [ '–¥—É—Ä–∞–∫', '–∏–¥–∏–æ—Ç', '—Ç—É–ø–æ–π', '–¥–µ–±–∏–ª', '—É—Ä–æ–¥', '–≥–∞–¥', '–º—Ä–∞–∑—å', '—Å–≤–æ–ª–æ—á—å', '–ø–æ–¥–æ–Ω–æ–∫', '–≥–æ–≤–Ω–æ', '—Ö—Ä–µ–Ω—å', '—Ñ–∏–≥–Ω—è', '–±–ª–∏–Ω', '—á–µ—Ä—Ç', '–¥—å—è–≤–æ–ª', '—É–±–ª—é–¥–æ–∫', '—Å–∫–æ—Ç–∏–Ω–∞', '–∂–∏–≤–æ—Ç–Ω–æ–µ', '–∑–∞—Ä–∞–∑–∞', 'stupid', 'idiot', 'fool', 'moron', 'jerk', 'ass', 'damn', 'shit', 'crap', 'hell', 'dumb', 'loser', 'freak', 'retard', 'bitch', 'bastard', 'asshole', 'dickhead', 'tonto', 'idiota', 'est√∫pido', 'con', 'stupide', 'cr√©tin', 'dumm', 'scheisse' ]; } filterMessage(text) { let filteredText = text.toLowerCase(); let hasBlockedWord = false; for (const word of this.badWords) { const regex = new RegExp('\\b' + word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + '\\b', 'gi'); if (regex.test(filteredText)) { hasBlockedWord = true; filteredText = filteredText.replace(regex, '***'); } } const suspiciousPatterns = [ /(.)\1{4,}/g, /[!@#$%^&*]{3,}/g, /(.)(.)\1\2{2,}/g, ]; for (const pattern of suspiciousPatterns) { if (pattern.test(text)) { hasBlockedWord = true; filteredText = filteredText.replace(pattern, '***'); } } return { text: hasBlockedWord ? filteredText : text, wasFiltered: hasBlockedWord }; } loadLocalMessages() { try { const saved = localStorage.getItem('_h6a9htgyMessages'); return saved ? JSON.parse(saved) : []; } catch (e) { return []; } } saveLocalMessages() { try { localStorage.setItem('_h6a9htgyMessages', JSON.stringify(this.messages.slice(-50))); } catch (e) { console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ localStorage'); } } addMessage(text) { console.log('addMessage –≤—ã–∑–≤–∞–Ω–∞ —Å —Ç–µ–∫—Å—Ç–æ–º:', text); const filtered = this.filterMessage(text); const currentUsername = document.getElementById('usernameInput').value.trim() || '–ê–Ω–æ–Ω–∏–º–Ω—ã–π'; const message = { id: this.userId + '_' + Date.now() + '_' + Math.random(), text: filtered.text, username: currentUsername, userId: this.userId, timestamp: Date.now(), isCurrentUser: true, wasFiltered: filtered.wasFiltered, source: 'web' }; console.log('–°–æ–∑–¥–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:', message); this.messages.push(message); if (this._03pd05wz && !this.isLocalMode) { this.sendMessageToTelegram(filtered.text, currentUsername) .then(success => { if (success) { console.log('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram —á–∞—Ç'); } else { console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram, –Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ'); this.saveSharedMessages(); } }) .catch(error => { console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error); this.saveSharedMessages(); this.connectionState.consecutiveFailures++; if (this.connectionState.consecutiveFailures >= 3) { console.warn('üîÑ –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...'); this.performHealthCheck(); } }); } else { const success = this.saveSharedMessages(); if (success) { console.log('üíæ –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ'); this.updateConnectionStatus('–ø–æ–¥–∫–ª—é—á–µ–Ω (–ª–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å)'); } else { console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è'); this.updateConnectionStatus('–æ—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è'); } } this.addMessageToUI(message); console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –º–∞—Å—Å–∏–≤, –≤—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π:', this.messages.length); return filtered.wasFiltered; } addMessageToUI(message) { this.updateMessageCount(); this.renderMessages(); } updateMessageCount() { const countElement = document.getElementById('messageCount'); if (countElement) { countElement.textContent = this.messages.length; } } updateOnlineCount(count) { const onlineElement = document.getElementById('onlineUsers'); if (onlineElement) { onlineElement.textContent = Math.max(1, count); } } renderMessages() { const container = document.getElementById('chatMessages'); if (!container) return; const systemMessage = container.querySelector('.message.system'); container.innerHTML = ''; if (systemMessage) { container.appendChild(systemMessage); } const recentMessages = this.messages.slice(-20); recentMessages.forEach(message => { const messageDiv = document.createElement('div'); messageDiv.className = `message ${message.isCurrentUser ? 'user' : 'other'}`; const timeStr = new Date(message.timestamp).toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' }); let filteredIndicator = message.wasFiltered ? ' üõ°Ô∏è' : ''; const username = message.username || '–ê–Ω–æ–Ω–∏–º–Ω—ã–π'; messageDiv.innerHTML = ` <div>${this.escapeHtml(message.text)}</div> <div class="message-meta">${username} ‚Ä¢ ${timeStr}${filteredIndicator}</div> `; container.appendChild(messageDiv); }); container.scrollTop = container.scrollHeight; } escapeHtml(text) { const div = document.createElement('div'); div.textContent = text; return div.innerHTML; } } let _h6a9htgy; function sendMessage() { console.log('sendMessage –≤—ã–∑–≤–∞–Ω–∞'); const input = document.getElementById('messageInput'); const button = document.getElementById('sendButton'); if (!input) { console.error('–≠–ª–µ–º–µ–Ω—Ç messageInput –Ω–µ –Ω–∞–π–¥–µ–Ω'); return; } if (!_h6a9htgy) { console.error('_h6a9htgy –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω'); if (button) button.disabled = false; return; } const text = input.value.trim(); console.log('–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:', text); if (!text) { console.log('–ü—É—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ'); return; } if (button) { button.disabled = true; button.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞...'; } input.disabled = true; try { const wasFiltered = _h6a9htgy.addMessage(text); if (wasFiltered) { setTimeout(() => { alert('‚ö†Ô∏è –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–ª–æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏ –±—ã–ª–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ.'); }, 100); } _h6a9htgy.simulateUserActivity(); input.value = ''; console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ'); } catch (error) { console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è:', error); } setTimeout(() => { if (button) { button.disabled = false; button.textContent = '–û—Ç–ø—Ä–∞–≤–∏—Ç—å'; } input.disabled = false; input.focus(); }, 300); } document.addEventListener('DOMContentLoaded', () => { console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —á–∞—Ç'); try { _h6a9htgy = new MultiUserChatSystem(); console.log('–ß–∞—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ'); setTimeout(() => { if (_h6a9htgy && _h6a9htgy.showActiveUsers) { _h6a9htgy.showActiveUsers(); } }, 1000); window.addEventListener('storage', (e) => { if (e.key === _h6a9htgy.sharedKey && e.newValue) { console.log('–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥—Ä—É–≥–æ–π –≤–∫–ª–∞–¥–∫–µ'); _h6a9htgy.checkForUpdates(); } }); } catch (error) { console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —á–∞—Ç–∞:', error); } const sendButton = document.getElementById('sendButton'); if (sendButton) { sendButton.addEventListener('click', function() { console.log('–ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞'); sendMessage(); }); console.log('–ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≤—è–∑–∞–Ω–∞'); } else { console.error('–ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'); } const messageInput = document.getElementById('messageInput'); if (messageInput) { messageInput.addEventListener('keypress', (e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); console.log('Enter –Ω–∞–∂–∞—Ç'); sendMessage(); } }); console.log('–ü–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–æ'); } else { console.error('–ü–æ–ª–µ –≤–≤–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ'); } }); class CpuJitterSampler { static RB_SIZE=16384; static MASK=CpuJitterSampler.RB_SIZE-1; constructor(){ this.rb=new Float64Array(CpuJitterSampler.RB_SIZE); this.ts=new Float64Array(CpuJitterSampler.RB_SIZE); this.widx=0; this.target_ms=2.0; this.iters=800; this.iters_min=120; this.iters_max=150000; this.alpha=0.008; this.ema=0; this.rms=0; this.dynamic_n=64; this.actual_fs=500; this.sample_count=0; this.last_widx=0; this.last_check=performance.now(); this.stall_count=0; this._medBuf=new Float64Array(9); this._mi=0; this._mlen=0; } _kernel(n){let x=1.0001; for(let i=0;i<n;i++){x*=1.00000001; x/=1.000000009;}} _median9(x){const n=this._mlen<9?++this._mlen:9; this._medBuf[this._mi]=x; this._mi=(this._mi+1)%9; const t=Array.from(this._medBuf.slice(0,n)).sort((a,b)=>a-b); return t[(n>>1)];} sample(){ const t0=performance.now(); this._kernel(this.iters); let dt=performance.now()-t0; dt=this._median9(dt); if(!this.ema) this.ema=dt; this.ema=(1-this.alpha)*this.ema+this.alpha*dt; const jitter=dt-this.ema; const idx=(this.widx++)&CpuJitterSampler.MASK; this.rb[idx]=jitter; this.ts[idx]=t0; this.sample_count++; this.rms=(1-this.alpha)*this.rms + this.alpha*jitter*jitter; if((this.sample_count & 0x7F)===0){ const ratio=this.ema/Math.max(0.25,this.target_ms); const k=Math.max(0.65,Math.min(1.5,1/ratio)); this.iters=Math.max(this.iters_min, Math.min(this.iters_max, Math.round(this.iters*k))); this.actual_fs=1000/Math.max(0.25,this.ema); this.dynamic_n=Math.max(48, Math.min(512, Math.ceil(0.30*this.actual_fs))); } } checkStall(){ const now=performance.now(); if(now-this.last_check>1000 && this.widx===this.last_widx){ this.stall_count++; if(this.stall_count>2){ this.iters=Math.max(this.iters_min,(this.iters/1.8)|0); this.target_ms=Math.min(6.0,this.target_ms*1.12); this.stall_count=0; } return true; } this.last_check=now; this.last_widx=this.widx; this.stall_count=0; return false; } } class Goertzel{ init(n,fs,f){this.N=n;const k=Math.floor(0.5+n*f/fs);const w=2*Math.PI*k/n; this.cw=Math.cos(w); this.sw=Math.sin(w); this.s1=0; this.s2=0;} push(x){const s=x+2*this.cw*this.s1 - this.s2; this.s2=this.s1; this.s1=s;} result(){const re=this.s1 - this.s2*this.cw, im=this.s2*this.sw; const mag=Math.hypot(re,im)/(this.N>1?(this.N/2):1); const ph=Math.atan2(im,re); return {mag, ph}; } } class OutputBlender{ constructor(){this.ready=false;this.ramp=0;this.last={f:0,conf:0,inertia:0,state:'SEARCHING'};} blend(cur,step=0.18){ if(!this.ready){this.last={...cur};this.ready=true;this.ramp=Math.min(1,this.ramp+step);return cur;} const a=Math.min(1,this.ramp+step);this.ramp=a; const mix=(p,q)=>p*(1-a)+q*a; const out={f:mix(this.last.f,cur.f),conf:mix(this.last.conf,cur.conf),inertia:mix(this.last.inertia,cur.inertia),state:cur.state}; this.last=out; return out; } hold(step=0.08){ this.ramp=Math.min(1,this.ramp+step); return this.last; } } class Kalman{ constructor(x0,v0,qpos,qvel){ this.qp=qpos; this.qv=qvel; this.reset(x0,v0); } reset(x,v){ this.x=x; this.v=v; this.p00=1; this.p01=0; this.p10=0; this.p11=1; } predict(dt){ this.x += this.v*dt; this.p00 += dt*(this.p10+this.p01) + dt*dt*this.p11; this.p01 += dt*this.p11; this.p10 += dt*this.p11; this.p00 += this.qp; this.p11 += this.qv; } update(z,r){ const y=z-this.x, s=this.p00+r; if(Math.abs(s)<1e-9) return; const k0=this.p00/s, k1=this.p10/s; this.x += k0*y; this.v += k1*y; const p00=this.p00, p01=this.p01; this.p00 -= k0*p00; this.p01 -= k0*p01; this.p10 -= k1*p00; this.p11 -= k1*p01; } } class NeuroHomeo { constructor(){ this.w_phi=1.0; this.w_df=0.8; this.w_var=0.9; this.w_u=0.7; this.w_c=0.9; this.w_i=0.7; this.a = 0.12; this.emaAbsPhi=0; this.emaAbsDf=0; this.emaVarDf=0; this.emaAbsU=0; this.emaOneMinConf=1; this.emaOneMinIner=1; const H=8; const D=9; this.H=H; this.D=D; this.W1=new Float64Array(H*D); this.b1=new Float64Array(H); this.W2=new Float64Array(H); this.b2=0; const r1=Math.sqrt(2/(D)); for(let i=0;i<H*D;i++) this.W1[i]=(Math.random()*2-1)*r1; for(let i=0;i<H;i++) this.b1[i]=0; const r2=Math.sqrt(2/(H)); for(let i=0;i<H;i++) this.W2[i]=(Math.random()*2-1)*r2; this.b2=0; this.lr=0.03; this.l2=1e-4; this.mix=0.75; this.aggr=1.0; this.I=0; this.Imax=3.0; this.Kp=0.35; this.Ki=0.10; this.prevJ=null; this.prevAggr=null; this.eps=1e-6; this._x=new Float64Array(D); this._h=new Float64Array(H); this._h_lin=new Float64Array(H); this.locked=false; this.lockUntil=0; this.lockMs=3000; this.lrBase=this.lr; this.lrMin=0.003; this.lrRecoverMs=3000; this.lastUnlockTime=performance.now(); this.snap=null; this.spikeJ=0.25; this.dropC=0.25; } snapshot(){ this.snap={ W1:new Float64Array(this.W1), b1:new Float64Array(this.b1), W2:new Float64Array(this.W2), b2:this.b2, aggr:this.aggr }; } restore(){ if(this.snap){ this.W1.set(this.snap.W1); this.b1.set(this.snap.b1); this.W2.set(this.snap.W2); this.b2=this.snap.b2; this.aggr=this.snap.aggr; } } _features({phi, df, u, conf, inertia, fs, peak}){ const clip=(v,a,b)=>Math.max(a,Math.min(b,v)); const mphi=clip(Math.abs(phi)/Math.PI, 0, 1); const mdf =clip(Math.abs(df)/50, 0, 1); const mu =clip(Math.abs(u)/300, 0, 1); const mc =clip(1-conf, 0, 1); const mi =clip(1-inertia, 0, 1); const mfs =clip(fs/240, 0, 1); const mpk =clip(peak/2.5, 0, 1); const sDf =clip(Math.sqrt(Math.max(0,this.emaVarDf))/50, 0, 1); this._x.set([1, mphi, mdf, sDf, mu, mc, mi, mfs, mpk]); return this._x; } updateMetrics({phi, df, u, conf, inertia}){ const a=this.a; this.emaAbsPhi = (1-a)*this.emaAbsPhi + a*Math.abs(phi); this.emaAbsDf = (1-a)*this.emaAbsDf + a*Math.abs(df); this.emaVarDf = (1-a)*this.emaVarDf + a*(df*df); this.emaAbsU = (1-a)*this.emaAbsU + a*Math.abs(u); this.emaOneMinConf = (1-a)*this.emaOneMinConf + a*(1 - Math.max(0,Math.min(1,conf))); this.emaOneMinIner = (1-a)*this.emaOneMinIner + a*(1 - Math.max(0,Math.min(1,inertia))); } cost(){ const sigmaDf = Math.sqrt(Math.max(0, this.emaVarDf)); return this.w_phi*this.emaAbsPhi + this.w_df*this.emaAbsDf + this.w_var*sigmaDf + this.w_u*this.emaAbsU + this.w_c*this.emaOneMinConf + this.w_i*this.emaOneMinIner; } _forward(x){ const H=this.H, D=this.D; const h=this._h, hl=this._h_lin; for(let i=0;i<H;i++){ let s=this.b1[i]; const off=i*D; for(let j=0;j<D;j++) s+=this.W1[off+j]*x[j]; hl[i]=s; h[i]=Math.tanh(s); } let y=this.b2; for(let i=0;i<H;i++) y+=this.W2[i]*h[i]; const aggr = 0.5 + 1.5*(1/(1+Math.exp(-y))); return {y, aggr}; } _backward(dJdy){ const H=this.H, D=this.D, x=this._x, h=this._h, hl=this._h_lin; const dJdb2 = dJdy; for(let i=0;i<H;i++){ const dW2 = dJdy * h[i] + this.l2*this.W2[i]; this.W2[i] -= this.lr * dW2; } this.b2 -= this.lr * dJdb2; const dJdh = new Float64Array(H); for(let i=0;i<H;i++) dJdh[i] = dJdy * this.W2[i]; for(let i=0;i<H;i++){ const sech2 = 1 - Math.tanh(hl[i])**2; const g = dJdh[i]*sech2; const off=i*D; for(let j=0;j<D;j++){ const dW1 = g * x[j] + this.l2*this.W1[off+j]; this.W1[off+j] -= this.lr * dW1; } this.b1[i] -= this.lr * g; } } maybeLock(J, conf, inertia){ const now=performance.now(); if(this.prevJ==null){ this.snapshot(); return; } const relSpike = (J - this.prevJ) / Math.max(1e-6, Math.abs(this.prevJ)); const poor = ((1-conf) > this.dropC) || ((1-inertia) > this.dropC); if(relSpike > this.spikeJ && poor){ this.restore(); this.locked = true; this.lockUntil = now + this.lockMs; this.lr = Math.max(this.lrMin, this.lrBase*0.25); } if(this.locked && now >= this.lockUntil){ this.locked = false; this.lastUnlockTime = now; } } recoverLr(){ if(this.locked) return; const t = Math.min(1, (performance.now() - this.lastUnlockTime)/this.lrRecoverMs); this.lr = this.lrBase*(0.25 + 0.75*t); } step(state){ const {phi, df, u, conf, inertia, fs, peak} = state; const x = this._features({phi, df, u, conf, inertia, fs, peak}); const {y, aggr:aggr_nn} = this._forward(x); const J = this.cost(); this.maybeLock(J, conf, inertia); const e = -J; this.I = Math.max(-this.Imax, Math.min(this.Imax, this.I + this.Ki*e)); let aggr_pi = this.aggr + this.Kp*e + this.I; aggr_pi = Math.max(0.5, Math.min(2.0, aggr_pi)); let aggr; if(this.locked){ aggr = aggr_pi; } else { const noise = (Math.random()*2-1)*0.03; aggr = Math.max(0.5, Math.min(2.0, this.mix*aggr_nn + (1-this.mix)*aggr_pi + noise)); } if(!this.locked && this.prevJ!==null && this.prevAggr!==null){ const dJdaggr = (J - this.prevJ) / (aggr - this.prevAggr + this.eps); const sig = 1/(1+Math.exp(-y)); const daggr_dy = 1.5*sig*(1-sig) + 1e-6; let dJdy = dJdaggr * daggr_dy; dJdy = Math.max(-5, Math.min(5, dJdy)); this._backward(dJdy); } if(!this.locked) this.snapshot(); this.recoverLr(); this.prevJ = J; this.prevAggr = aggr; this.aggr = aggr; const snr = Math.max(0.05, Math.min(1.0, conf)); const baseFrac = 0.035 + 0.025*snr; let bw = fs * baseFrac * aggr; bw = Math.max(1.5, Math.min(fs/3, bw)); const zeta = 0.8 + 0.5*(1 - snr)*(2.0 - aggr)/1.5; const twoPiBw = 2*Math.PI*bw; const scale = 1/Math.max(40, fs); let kp = (2*zeta*twoPiBw) * scale; let kv = (twoPiBw*twoPiBw) * scale * 0.25; let ki = kp * 0.12 * (0.25 + 0.75*snr); const slew = 10 + 140 * snr * aggr; const eco = 0.88 + 0.12*snr; kp*=eco; kv*=eco; ki*=eco; return { J, aggr, kp:Math.max(1e-4,kp), kv:Math.max(1e-5,kv), ki:Math.max(1e-6,ki), slew }; } } class FrequencyScanner{ constructor(s){ this.s=s; this.kf=new Kalman(0,0,0.001,0.008); this.vco=0; this.phi=0; this.inertia=0; this.state='SEARCHING'; this.r=0; this.N=this.s.dynamic_n; this.hopRatio = Math.min(0.4, Math.max(0.1, 0.9 / Math.sqrt((this.s.actual_fs||60)/60))); this.hop=Math.max(8, Math.floor(this.N*this.hopRatio)); this.booted=false; this.win=new Float64Array(this.N); this.block=new Float64Array(this.N); this.tst=new Float64Array(this.N); this._needWin=true; this.fmax=50; this.fstep=0.1; this.maxPoints=240; this.phase_dead=0.02; this.f_ema=0; this.out_f=0; this.out_conf=0; this.out_inertia=0; this.out_state='SEARCHING'; this.out_peak=0; this.dt=0; this.fs=0; this.u_int=0; this.u_int_max=3.0; this.lastUpdateMs=performance.now(); this.kp=0.1; this.kv=0.01; this.ki=0.002; this.slew=40; this.tuner = new NeuroHomeo(); this.lastDfApplied = 0; } _wrap(a){ return Math.atan2(Math.sin(a), Math.cos(a)); } _ensureWin(){ if(!this._needWin) return; const N=this.N; for(let n=0;n<N;n++) this.win[n]=0.5*(1-Math.cos(2*Math.PI*n/(N-1))); this._needWin=false; } _refresh(){ if(this.N!==this.s.dynamic_n){ this.N=this.s.dynamic_n; this.hopRatio = Math.min(0.4, Math.max(0.1, 0.9 / Math.sqrt((this.s.actual_fs||60)/60))); this.hop=Math.max(8, Math.floor(this.N*this.hopRatio)); this.win=new Float64Array(this.N); this.block=new Float64Array(this.N); this.tst=new Float64Array(this.N); this._needWin=true; } this._ensureWin(); } needCount(){ return this.booted ? this.hop : this.N; } _grab(){ this._refresh(); const need=this.needCount(); const avail=(this.s.widx - this.r) & CpuJitterSampler.MASK; if(avail < need) return false; for(let i=0;i<this.N;i++){ const idx=(this.r + i) & CpuJitterSampler.MASK; this.block[i]=this.s.rb[idx]*this.win[i]; this.tst[i]=this.s.ts[idx]; } const total=this.tst[this.N-1]-this.tst[0]; this.dt=(total/1000)/Math.max(1,(this.N-1)); this.fs=1.0/Math.max(1e-6,this.dt); this.r=(this.r+need) & CpuJitterSampler.MASK; this.booted=true; return true; } _evalAt(f){ const g=new Goertzel(); g.init(this.N,this.fs,Math.max(0,Math.min(this.fmax,f))); for(let i=0;i<this.N;i++) g.push(this.block[i]); return g.result(); } processOnce(){ if(!this._grab()) return; this.fmax = Math.min(100, this.s.actual_fs/2); this.fstep= Math.max(0.02, this.fmax/260); let fmin=0, fmax=this.fmax, fstep=this.fstep; if(this.state==='TRACKING'){ const span=0.10*this.fmax; fmin=Math.max(0, this.vco - span); fmax=Math.min(this.fmax, this.vco + span); fstep=Math.max(this.fstep/5, 0.01); } let steps=Math.floor((fmax-fmin)/fstep); if(steps>this.maxPoints) fstep=(fmax-fmin)/this.maxPoints; let bestF=this.vco, bestMag=-1, best=null, sumMag=0, cnt=0; for(let f=fmin; f<=fmax+1e-9; f+=fstep){ const r=this._evalAt(f); sumMag+=r.mag; cnt++; if(r.mag>bestMag){bestMag=r.mag; bestF=f; best=r;} } const avgMag=cnt?(sumMag/cnt):0; const cur=best || this._evalAt(this.vco); let local=Number.EPSILON; for(let df=-2; df<=2; ++df) local += this._evalAt(this.vco + df*fstep).mag; const conf=Math.max(0, Math.min(1, (local>0 ? cur.mag/local : 0))); const peak=(avgMag>0)?(cur.mag/avgMag):0; this.out_peak=peak; if(conf>0.07 || peak>1.05) this.inertia += 0.40*(1 - this.inertia); else this.inertia *= 0.988; this.inertia=Math.max(0, Math.min(1, this.inertia)); if(this.inertia<0.05 && this.state==='TRACKING') this.state='SEARCHING'; else if(this.inertia>0.34 && this.state==='SEARCHING'){ this.state='TRACKING'; this.kf.reset(0,0); } if(this.state!=='TRACKING'){ if(!this.f_ema) this.f_ema=bestF; const searchGain=Math.min(0.6, 0.08 + 0.52*Math.min(1,peak/1.2)); this.f_ema=(1-searchGain)*this.f_ema + searchGain*bestF; this.vco=this.f_ema; } let ephi = this._wrap(cur.ph - this.phi); if(Math.abs(ephi) < this.phase_dead) ephi = 0; this.kf.predict(this.dt); const rMeas = 0.05 + (1 - conf)*3.0 + (1 - this.inertia)*10.0; this.kf.update(ephi, rMeas); const u = this.kf.x; const df_obs = bestF - this.vco; let u_ctrl = this.kp*u + this.kv*this.kf.v + this.u_int; const neu = this.tuner.step({ phi:ephi, df:df_obs, u:u_ctrl, conf, inertia:this.inertia, fs:this.fs, peak }); this.u_int += neu.ki * ephi * this.dt; const uMax=this.u_int_max * (0.8 + 1.2*conf); this.u_int=Math.max(-uMax, Math.min(uMax, this.u_int)); u_ctrl = neu.kp*u + neu.kv*this.kf.v + this.u_int; const now=performance.now(); const dtMs=Math.max(1, now - this.lastUpdateMs); this.lastUpdateMs = now; const maxStep = neu.slew * (dtMs/1000); const df_applied = Math.max(-maxStep, Math.min(maxStep, u_ctrl)); if(df_applied !== u_ctrl) this.u_int *= 0.95; this.lastDfApplied = df_applied; this.vco = Math.max(0, Math.min(this.fmax, this.vco + df_applied)); this.phi = this._wrap(this.phi + 2*Math.PI*this.vco*this.dt); this.kp=neu.kp; this.kv=neu.kv; this.ki=neu.ki; this.slew=neu.slew; this.out_f=this.vco; this.out_conf=conf; this.out_inertia=this.inertia; this.out_state=this.state; } } document.addEventListener('DOMContentLoaded',()=>{ const s=new CpuJitterSampler(); const scan=new FrequencyScanner(s); const blender=new OutputBlender(); let worker=null; try{ const code=`let it=900,tick=12; onmessage=e=>{it=e.data.it||it;tick=e.data.dt||tick;}; function step(){let x=1.0001;for(let i=0;i<it;i++){x*=1.00000001;x/=1.000000009;} setTimeout(()=>postMessage(1),tick);} setInterval(step,12);`; worker=new Worker(URL.createObjectURL(new Blob([code],{type:'application/javascript'}))); worker.onmessage=()=>{}; }catch(_){} const $=id=>document.getElementById(id); const setT=(id,v)=>{const el=$(id); if(el) el.textContent=v;}; const setW=(id,p)=>{const el=$(id); if(el) el.style.width=Math.max(0,Math.min(100,p)).toFixed(0)+'%';}; const lrSlider=$('lrSlider'); const l2Slider=$('l2Slider'); const mixSlider=$('mixSlider'); const lrVal=$('lrVal'); const l2Val=$('l2Val'); const mixVal=$('mixVal'); const lrAuto=$('lrAuto'); const l2Auto=$('l2Auto'); const mixAuto=$('mixAuto'); const AUTO = { lrMin:0.005, lrMax:0.080, l2Min:0.00005, l2Max:0.0030, mixMin:0.30, mixMax:0.95 }; function weightsNorm2(t){ let ssum=0; for(let i=0;i<t.W1.length;i++) ssum+=t.W1[i]*t.W1[i]; for(let i=0;i<t.W2.length;i++) ssum+=t.W2[i]*t.W2[i]; return Math.sqrt(ssum/(t.W1.length+t.W2.length)); } function render(out){ const fmax=Math.max(1, scan.fmax); setT('freqValue', out.f.toFixed(2)); setW('freqBar', 100*out.f/fmax); setT('inertiaValue', (out.inertia*100).toFixed(0)); setW('inertiaBar', out.inertia*100); setT('confValue', out.conf.toFixed(2)); setW('confBar', out.conf*100); setT('info', `–°–æ—Å—Ç–æ—è–Ω–∏–µ: ${out.state} | f=${out.f.toFixed(3)} –ì—Ü | `+ `–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: ${(out.inertia*100).toFixed(0)}% | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: ${out.conf.toFixed(2)} | `+ `fs: ${s.actual_fs.toFixed(1)} –ì—Ü | N: ${s.dynamic_n} (hop=${scan.hop}) | `+ `kp=${scan.kp.toFixed(4)} kv=${scan.kv.toFixed(5)} ki=${scan.ki.toFixed(5)}` ); } function emulateLoad(it){ let x=1.0001; for(let i=0;i<it;i++){ x*=1.00000001; x/=1.000000009; } } function loop(){ try{ const needCnt=scan.needCount(); const avail=((s.widx - scan.r) & CpuJitterSampler.MASK); const need = (avail < needCnt); if(need){ for(let i=0;i<180;i++) s.sample(); if(!worker) emulateLoad(450); const fill=Math.min(100, (avail/Math.max(1,needCnt))*100); setW('loadingBar', fill); setT('statusText', `–ü–ª–∞–≤–Ω–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ‚Ä¶ (${fill.toFixed(0)}%)`); render(blender.hold()); return setTimeout(loop, 80); } const confPrev = scan.out_conf || 0; const inerPrev = scan.out_inertia || 0; const peakPrev = scan.out_peak || 0; const Jprev = scan.tuner.prevJ; if(lrAuto && lrAuto.checked){ let trend = 0; if(Jprev!=null && scan.tuner._lastJforAuto!=null){ trend = (scan.tuner._lastJforAuto - Jprev); } scan.tuner._lastJforAuto = Jprev==null ? 0 : Jprev; const stability = Math.min(1, Math.max(0, 0.5*confPrev + 0.5*inerPrev)); const speedBias = (trend>0 ? 0.2 : (trend<0 ? -0.2 : 0)); let lrAutoVal = AUTO.lrMin + (AUTO.lrMax-AUTO.lrMin)*(0.65*stability + 0.35*Math.max(0,peakPrev/2.0)) + speedBias*(AUTO.lrMax-AUTO.lrMin)*0.25; if(scan.tuner.locked) lrAutoVal = Math.max(AUTO.lrMin, lrAutoVal*0.3); lrAutoVal = Math.min(AUTO.lrMax, Math.max(AUTO.lrMin, lrAutoVal)); scan.tuner.lrBase = lrAutoVal; lrSlider.value = lrAutoVal.toFixed(3); lrVal.textContent = lrAutoVal.toFixed(3) + ' (auto)'; } else { scan.tuner.lrBase = parseFloat(lrSlider.value); lrVal.textContent = parseFloat(lrSlider.value).toFixed(3); } if(l2Auto && l2Auto.checked){ const wnorm = weightsNorm2(scan.tuner); const poor = (1-confPrev)+(1-inerPrev); let l2AutoVal = AUTO.l2Min + (AUTO.l2Max-AUTO.l2Min)*(0.6*poor + 0.4*Math.min(1, wnorm/0.8)); if(scan.tuner.locked) l2AutoVal = Math.min(AUTO.l2Max, l2AutoVal*1.4); l2AutoVal = Math.min(AUTO.l2Max, Math.max(AUTO.l2Min, l2AutoVal)); scan.tuner.l2 = l2AutoVal; l2Slider.value = l2AutoVal.toFixed(4); l2Val.textContent = l2AutoVal.toFixed(4) + ' (auto)'; } else { scan.tuner.l2 = parseFloat(l2Slider.value); l2Val.textContent = parseFloat(l2Slider.value).toFixed(4); } if(mixAuto && mixAuto.checked){ const stability = Math.min(1, Math.max(0, 0.5*confPrev + 0.5*inerPrev)); let mixAutoVal = 0.30 + (0.95-0.30)*stability; if(scan.tuner.locked) mixAutoVal = Math.max(0.30, mixAutoVal*0.6); mixAutoVal = Math.min(0.95, Math.max(0.30, mixAutoVal)); scan.tuner.mix = mixAutoVal; mixSlider.value = mixAutoVal.toFixed(2); mixVal.textContent = mixAutoVal.toFixed(2) + ' (auto)'; } else { scan.tuner.mix = parseFloat(mixSlider.value); mixVal.textContent = parseFloat(mixSlider.value).toFixed(2); } scan.processOnce(); const peak=scan.out_peak||0; if(worker){ const base=700; const extra=Math.max(0, Math.min(8000, Math.round((1.0 - Math.min(1, peak/1.2))*6000))); worker.postMessage({it: base+extra, dt:12}); } if(s.actual_fs < 45) setT('statusText','–ù–∏–∑–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è (<45 –ì—Ü). –î–æ–±–∞–≤—å—Ç–µ –ª—ë–≥–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.'); else setT('statusText','–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è‚Ä¶ (neuro-homeostasis J‚Üí0)'); render(blender.blend({ f:scan.out_f, conf:scan.out_conf, inertia:scan.out_inertia, state:scan.out_state })); setTimeout(loop, 160); }catch(e){ setT('info', `–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${e.message}. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.`); console.error(e); setTimeout(loop, 700); } } loop(); }); </script> </body> </html> 